<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 2 Ajuste funcional | Estadística I: Análisis exploratorio de datos y muestreo</title>
  <meta name="description" content="Libro de estadística aplicada: temas de análisis exploratorio y muestreo" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 2 Ajuste funcional | Estadística I: Análisis exploratorio de datos y muestreo" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Libro de estadística aplicada: temas de análisis exploratorio y muestreo" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 2 Ajuste funcional | Estadística I: Análisis exploratorio de datos y muestreo" />
  
  <meta name="twitter:description" content="Libro de estadística aplicada: temas de análisis exploratorio y muestreo" />
  

<meta name="author" content="Rodrigo Zepeda-Tello" />


<meta name="date" content="2020-08-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="ejercicios-1.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Estadística I: Análisis exploratorio de datos y muestreo</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prefacio</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#inicio"><i class="fa fa-check"></i><b>1.1</b> Inicio</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#librerías"><i class="fa fa-check"></i><b>1.2</b> Librerías</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#base-a-analizar"><i class="fa fa-check"></i><b>1.3</b> Base a analizar</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#definiciones-y-notación"><i class="fa fa-check"></i><b>1.4</b> Definiciones y notación</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#estadísticos-univariados"><i class="fa fa-check"></i><b>1.5</b> Estadísticos univariados</a><ul>
<li class="chapter" data-level="1.5.1" data-path="index.html"><a href="index.html#definición-estadístico"><i class="fa fa-check"></i><b>1.5.1</b> Definición [Estadístico]</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#ejercicios"><i class="fa fa-check"></i><b>1.6</b> Ejercicios</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#gráficas-univariadas"><i class="fa fa-check"></i><b>1.7</b> Gráficas univariadas</a></li>
<li class="chapter" data-level="1.8" data-path="index.html"><a href="index.html#gráficas-bivariadas"><i class="fa fa-check"></i><b>1.8</b> Gráficas bivariadas</a><ul>
<li class="chapter" data-level="1.8.1" data-path="index.html"><a href="index.html#ejercicio"><i class="fa fa-check"></i><b>1.8.1</b> Ejercicio</a></li>
</ul></li>
<li class="chapter" data-level="1.9" data-path="index.html"><a href="index.html#estadísticos-bivariados"><i class="fa fa-check"></i><b>1.9</b> Estadísticos bivariados</a><ul>
<li class="chapter" data-level="1.9.1" data-path="index.html"><a href="index.html#ejercicio-1"><i class="fa fa-check"></i><b>1.9.1</b> Ejercicio</a></li>
</ul></li>
<li class="chapter" data-level="1.10" data-path="index.html"><a href="index.html#ejercicio-2"><i class="fa fa-check"></i><b>1.10</b> Ejercicio</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="ajuste-funcional.html"><a href="ajuste-funcional.html"><i class="fa fa-check"></i><b>2</b> Ajuste funcional</a><ul>
<li class="chapter" data-level="2.1" data-path="ajuste-funcional.html"><a href="ajuste-funcional.html#introducción"><i class="fa fa-check"></i><b>2.1</b> Introducción</a><ul>
<li class="chapter" data-level="2.1.1" data-path="ajuste-funcional.html"><a href="ajuste-funcional.html#ejercicio-3"><i class="fa fa-check"></i><b>2.1.1</b> Ejercicio</a></li>
<li class="chapter" data-level="2.1.2" data-path="ajuste-funcional.html"><a href="ajuste-funcional.html#ejercicio-sugerido"><i class="fa fa-check"></i><b>2.1.2</b> Ejercicio sugerido</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ejercicios-1.html"><a href="ejercicios-1.html"><i class="fa fa-check"></i><b>3</b> Ejercicios</a></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a></li>
<li class="appendix"><span><b>Apéndice</b></span></li>
<li class="chapter" data-level="A" data-path="programación-en-r.html"><a href="programación-en-r.html"><i class="fa fa-check"></i><b>A</b> Programación en <code>R</code></a><ul>
<li class="chapter" data-level="A.1" data-path="programación-en-r.html"><a href="programación-en-r.html#algunas-ventajas-de-r-y-cosas-no-tan-padres"><i class="fa fa-check"></i><b>A.1</b> Algunas ventajas de <code>R</code> y cosas no tan padres</a><ul>
<li class="chapter" data-level="A.1.1" data-path="programación-en-r.html"><a href="programación-en-r.html#puntos-a-favor-de-r"><i class="fa fa-check"></i><b>A.1.1</b> Puntos a favor de <code>R</code></a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="programación-en-r.html"><a href="programación-en-r.html#bienvenidx-a-r-taking-off-again-sí-así-se-llama-esta-versión"><i class="fa fa-check"></i><b>A.2</b> Bienvenidx a <code>R</code>, Taking Off Again (sí, así se llama esta versión)</a></li>
<li class="chapter" data-level="A.3" data-path="programación-en-r.html"><a href="programación-en-r.html#instalando-cosas"><i class="fa fa-check"></i><b>A.3</b> Instalando cosas</a><ul>
<li class="chapter" data-level="A.3.1" data-path="programación-en-r.html"><a href="programación-en-r.html#instalación-de-r"><i class="fa fa-check"></i><b>A.3.1</b> Instalación de <code>R</code></a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="programación-en-r.html"><a href="programación-en-r.html#instalación-de-rstudio"><i class="fa fa-check"></i><b>A.4</b> Instalación de <code>RStudio</code></a></li>
<li class="chapter" data-level="A.5" data-path="programación-en-r.html"><a href="programación-en-r.html#primeros-pasos-en-r-usando-rstudio"><i class="fa fa-check"></i><b>A.5</b> Primeros pasos en <code>R</code> usando <code>RStudio</code></a></li>
<li class="chapter" data-level="A.6" data-path="programación-en-r.html"><a href="programación-en-r.html#cálculos-numéricos"><i class="fa fa-check"></i><b>A.6</b> Cálculos numéricos</a><ul>
<li class="chapter" data-level="A.6.1" data-path="index.html"><a href="index.html#ejercicio"><i class="fa fa-check"></i><b>A.6.1</b> Ejercicio</a></li>
<li class="chapter" data-level="A.6.2" data-path="index.html"><a href="index.html#ejercicio-1"><i class="fa fa-check"></i><b>A.6.2</b> Ejercicio</a></li>
<li class="chapter" data-level="A.6.3" data-path="programación-en-r.html"><a href="programación-en-r.html#respuestas"><i class="fa fa-check"></i><b>A.6.3</b> Respuestas</a></li>
</ul></li>
<li class="chapter" data-level="A.7" data-path="programación-en-r.html"><a href="programación-en-r.html#variables"><i class="fa fa-check"></i><b>A.7</b> Variables</a><ul>
<li class="chapter" data-level="A.7.1" data-path="index.html"><a href="index.html#ejercicios"><i class="fa fa-check"></i><b>A.7.1</b> Ejercicios</a></li>
<li class="chapter" data-level="A.7.2" data-path="programación-en-r.html"><a href="programación-en-r.html#nivel-3"><i class="fa fa-check"></i><b>A.7.2</b> NIVEL 3</a></li>
</ul></li>
<li class="chapter" data-level="A.8" data-path="programación-en-r.html"><a href="programación-en-r.html#observaciones-sobre-la-aritmética-de-punto-flotante"><i class="fa fa-check"></i><b>A.8</b> Observaciones sobre la aritmética de punto flotante</a><ul>
<li class="chapter" data-level="A.8.1" data-path="programación-en-r.html"><a href="programación-en-r.html#cómo-checar-un-if"><i class="fa fa-check"></i><b>A.8.1</b> ¿Cómo checar un if?</a></li>
</ul></li>
<li class="chapter" data-level="A.9" data-path="programación-en-r.html"><a href="programación-en-r.html#leer-y-almacenar-variables-en-r"><i class="fa fa-check"></i><b>A.9</b> Leer y almacenar variables en <code>R</code></a><ul>
<li class="chapter" data-level="A.9.1" data-path="index.html"><a href="index.html#ejercicio-2"><i class="fa fa-check"></i><b>A.9.1</b> Ejercicio</a></li>
</ul></li>
<li class="chapter" data-level="A.10" data-path="programación-en-r.html"><a href="programación-en-r.html#instalación-de-paquetes"><i class="fa fa-check"></i><b>A.10</b> Instalación de paquetes</a><ul>
<li class="chapter" data-level="A.10.1" data-path="ejercicios-1.html"><a href="ejercicios-1.html#ejercicios-1"><i class="fa fa-check"></i><b>A.10.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="A.11" data-path="programación-en-r.html"><a href="programación-en-r.html#comentarios-adicionales-sobre-el-formato"><i class="fa fa-check"></i><b>A.11</b> Comentarios adicionales sobre el formato</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Rodrigo Zepeda Tello</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Estadística I: Análisis exploratorio de datos y muestreo</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ajuste-funcional" class="section level1">
<h1><span class="header-section-number">Capítulo 2</span> Ajuste funcional</h1>
<div id="introducción" class="section level2">
<h2><span class="header-section-number">2.1</span> Introducción</h2>
<p>Hacemos una apuesta por teléfono. Yo voy a tirar una moneda <span class="math inline">\(10\)</span> veces y si salen más <code>Soles</code> que <code>Águilas</code> yo gano 50 pesos. Si salen más <code>Águilas</code> que <code>Soles</code> tú ganas la misma cantidad. Al realizar el ejercicio yo te comunico que salieron en total <span class="math inline">\(10\)</span> <code>Soles</code> y por tanto me debes el dinero. <em>¿Sospecharías algo de mí?</em></p>
<p>Si no hablamos de probabilidad no hay forma en la que se pueda justificar que <em>aparentemente</em> hay algo raro con la moneda. Claro, siempre puede ser un caso improbable (<a href="https://www.youtube.com/watch?v=rwvIGNXY21Y">hay gente que lo ha hecho</a>) pero es <em>raro</em> que me hayan salido tantos <code>Soles</code>. Para cuantificar qué tan raro es el evento podemos suponer que las monedas siguen un modelo Binomial con parámetro <span class="math inline">\(p = 1/2\)</span> y en este caso <span class="math inline">\(n = 10\)</span> (fueron 10 tiros). La probabilidad de que haya obtenido <span class="math inline">\(10\)</span> soles bajo este modelo es de:</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="ajuste-funcional.html#cb136-1"></a><span class="kw">dbinom</span>(<span class="dv">10</span>,<span class="dv">10</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.0009765625</code></pre>
<p>¡Rarísimo! Este resultado te haría sospechar que quizá mi moneda no es <em>justa</em> y no se obtienen la misma cantidad de <code>Águilas</code> que <code>Soles</code> cuando la tiro. Esto porque, aparentemente, en mi moneda la probabilidad de <code>Sol</code> debería de ser <span class="math inline">\(p = 1\)</span> (por tu triste experiencia). Si por ejemplo en el onceavo tiro saliera un <code>Águila</code>, concluirías que, en mi moneda, aparentemente, la probabilidad de <code>Sol</code> es <span class="math inline">\(p = \frac{10}{11}\)</span>. Por supuesto, entre más tiros y más información obtienes, mejor podrás caracterizar la moneda y con mayor sustento tendrás sospechas (o no) de que mi moneda es tramposa.</p>
<p>Formalmente, en el ejemplo anterior, lo que se hace es suponer que existe una variable aleatoria <span class="math inline">\(X \in\{ \text{Águila}, \text{Sol}\}\)</span> (el resultado de la moneda) de la cual observamos <span class="math inline">\(n = 11\)</span> realizaciones codificadas en el siguiente vector:</p>
<p><span class="math display">\[
\vec{x} = \big( \text{Sol}, \text{Sol},\text{Sol},\text{Sol},\text{Sol},\text{Sol},\text{Sol},\text{Sol},\text{Sol},\text{Sol},\text{Águila}\big)^T
\]</span></p>
<p>Aproximamos entonces la probabilidad <span class="math inline">\(\mathbb{P}(X = \text{Sol})\)</span> mediante:</p>
<p><span class="math display">\[
\mathbb{P}(X = \text{Sol}) \approx \dfrac{1}{n}\sum\limits_{i=1}^n \mathbb{I}_{\{\text{Sol}\}}(x_i) = \dfrac{10}{11}
\]</span></p>
<p>Mientras que la de Águila se aproxima mediante:</p>
<p><span class="math display">\[
\mathbb{P}(X = \text{Águila}) \approx \dfrac{1}{n}\sum\limits_{i=1}^n \mathbb{I}_{\{\text{Águila}\}}(x_i) = \dfrac{1}{11}
\]</span></p>
<p>Para ver que éstas son buenas aproximaciones, podemos considerar un vector aleatorio de los <em>posibles</em> datos observados:
<span class="math display">\[
\vec{X} = (X_1, X_2, \dots, X_{11})^T
\]</span>
Donde <span class="math inline">\(X_1\)</span> es una variable aleatoria que representa lo que <em>pudo</em> haber salido en el primer tiro, <span class="math inline">\(X_2\)</span> es una v.a. que representa lo que <em>pudo</em> haber salido en el segundo tiro y en general <span class="math inline">\(X_k\)</span> es una v.a. que representa lo que <em>pudo</em> haber salido en el <span class="math inline">\(k\)</span>-ésimo tiro.</p>
<p>Suponiendo que la moneda tiene una probabilidad <span class="math inline">\(p\)</span> de arrojar <code>Sol</code> y <span class="math inline">\(1-p\)</span> de arrojar <code>Águila</code>, notamos que las variables indicadoras evaluadas en las <span class="math inline">\(X_i\)</span> (aleatorias) son variables aleatorias
<span class="math display">\[
\mathbb{I}_{\{\text{Sol}\}}(X_i) \sim \text{Beroulli}(p)
\]</span>
y que por tanto
<span class="math display">\[
\hat{p} = \dfrac{1}{n}\sum\limits_{i=1}^n \mathbb{I}_{\{\text{Sol}\}}(X_i)
\]</span>
es una variable aleatoria (al ser suma de variables aleatorias). Podemos entonces calcular su valor esperado:
<span class="math display">\[
\mathbb{E}\big[\hat{p}\big] = \mathbb{E}\bigg[\dfrac{1}{n}\sum\limits_{i=1}^n \mathbb{I}_{\{\text{Sol}\}}(X_i)\bigg] = \dfrac{1}{n}\sum\limits_{i=1}^n \mathbb{E}\big[ \mathbb{I}_{\{\text{Sol}\}}(X_i)\big] = \dfrac{1}{n}\sum\limits_{i=1}^n p = \dfrac{1}{n}\cdot np = p
\]</span>
Es decir, que en promedio el estimador <span class="math inline">\(\hat{p}\)</span> va a atinarle al verdadero valor <span class="math inline">\(p\)</span>. Esto lo podemos ver si hacemos <code>nsim</code><span class="math inline">\(= 1000\)</span> simulaciones de <span class="math inline">\(100\)</span> <code>tiros</code> de una moneda con probabilidad <code>p</code><span class="math inline">\(= 8/10\)</span> de sol.</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="ajuste-funcional.html#cb138-1"></a>nsim  &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb138-2"><a href="ajuste-funcional.html#cb138-2"></a>tiros &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb138-3"><a href="ajuste-funcional.html#cb138-3"></a>p.val &lt;-<span class="st"> </span><span class="dv">8</span><span class="op">/</span><span class="dv">10</span></span>
<span id="cb138-4"><a href="ajuste-funcional.html#cb138-4"></a></span>
<span id="cb138-5"><a href="ajuste-funcional.html#cb138-5"></a><span class="co">#Creamos un vector para guardar los valores de p gorro</span></span>
<span id="cb138-6"><a href="ajuste-funcional.html#cb138-6"></a>p.gorro &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, nsim)</span>
<span id="cb138-7"><a href="ajuste-funcional.html#cb138-7"></a></span>
<span id="cb138-8"><a href="ajuste-funcional.html#cb138-8"></a><span class="co">#Loop recorriendo cada una de las nsim simulaciones</span></span>
<span id="cb138-9"><a href="ajuste-funcional.html#cb138-9"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nsim){</span>
<span id="cb138-10"><a href="ajuste-funcional.html#cb138-10"></a>  experimento &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;Sol&quot;</span>,<span class="st">&quot;Águila&quot;</span>), tiros, <span class="dt">replace =</span> <span class="ot">TRUE</span>, </span>
<span id="cb138-11"><a href="ajuste-funcional.html#cb138-11"></a>                        <span class="dt">prob =</span> <span class="kw">c</span>(p.val, <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p.val))</span>
<span id="cb138-12"><a href="ajuste-funcional.html#cb138-12"></a>  soles       &lt;-<span class="st"> </span><span class="kw">table</span>(experimento)[<span class="st">&quot;Sol&quot;</span>]</span>
<span id="cb138-13"><a href="ajuste-funcional.html#cb138-13"></a>  p.gorro[i]  &lt;-<span class="st"> </span>soles<span class="op">/</span>tiros</span>
<span id="cb138-14"><a href="ajuste-funcional.html#cb138-14"></a>}</span></code></pre></div>
<p>Podemos ver que en promedio le atinamos al valor verdadero:</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="ajuste-funcional.html#cb139-1"></a><span class="co">#Vemos que en promedio le atina:</span></span>
<span id="cb139-2"><a href="ajuste-funcional.html#cb139-2"></a><span class="kw">mean</span>(p.gorro)</span></code></pre></div>
<pre><code>## [1] 0.80131</code></pre>
<p>Lo mismo podemos verlo gráficamente:</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="ajuste-funcional.html#cb141-1"></a><span class="co">#Graficamos</span></span>
<span id="cb141-2"><a href="ajuste-funcional.html#cb141-2"></a><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb141-3"><a href="ajuste-funcional.html#cb141-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span>nsim, <span class="dt">y =</span> p.gorro, <span class="dt">color =</span> <span class="kw">as.character</span>(p.gorro)), </span>
<span id="cb141-4"><a href="ajuste-funcional.html#cb141-4"></a>             <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.2</span>) <span class="op">+</span></span>
<span id="cb141-5"><a href="ajuste-funcional.html#cb141-5"></a><span class="st">  </span><span class="kw">geom_hline</span>(<span class="kw">aes</span>(<span class="dt">yintercept =</span> p.val), <span class="dt">size =</span> <span class="fl">1.5</span>, <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>) <span class="op">+</span></span>
<span id="cb141-6"><a href="ajuste-funcional.html#cb141-6"></a><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span></span>
<span id="cb141-7"><a href="ajuste-funcional.html#cb141-7"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb141-8"><a href="ajuste-funcional.html#cb141-8"></a><span class="st">  </span><span class="kw">labs</span>(</span>
<span id="cb141-9"><a href="ajuste-funcional.html#cb141-9"></a>    <span class="dt">x =</span> <span class="st">&quot;Simulaciones&quot;</span>,</span>
<span id="cb141-10"><a href="ajuste-funcional.html#cb141-10"></a>    <span class="dt">y =</span> <span class="st">&quot;Estimación de p&quot;</span>,</span>
<span id="cb141-11"><a href="ajuste-funcional.html#cb141-11"></a>    <span class="dt">title =</span> <span class="st">&quot;Simulación de proceso de estimación\nde que una moneda caiga Sol&quot;</span></span>
<span id="cb141-12"><a href="ajuste-funcional.html#cb141-12"></a>  ) <span class="op">+</span></span>
<span id="cb141-13"><a href="ajuste-funcional.html#cb141-13"></a><span class="st">  </span><span class="kw">geom_label</span>(<span class="kw">aes</span>(<span class="dt">x =</span> nsim<span class="op">/</span><span class="dv">2</span>, <span class="dt">y =</span> p.val), <span class="dt">label =</span> <span class="st">&quot;Verdadero valor de p&quot;</span>)</span></code></pre></div>
<p><img src="Introduccion_a_Muestreo_files/figure-html/unnamed-chunk-118-1.png" width="672" /></p>
<p><em>¿Qué significa esto?</em> El que en promedio <span class="math inline">\(\hat{p}\)</span> sea <span class="math inline">\(p\)</span> (formalmente, que <span class="math inline">\(\mathbb{E}\big[\hat{p}\big] = p\)</span>) significa que, si yo hago muchísimos experimentos (o procesos de muestreo) de la misma cosa, mi <span class="math inline">\(\hat{p}\)</span> es un buen estimador porque en promedio le va a atinar. Empero, esto no dice nada de qué tan bueno es mi estimador <span class="math inline">\(\hat{p}\)</span> para mi caso (mi muestra o mi experimento) específico. Puedes pensarlo con los exámenes: que alguien tenga un promedio de <em>8</em> dice que en general le ha ido bien en los exámenes, pero no dice nada respecto al primer examen de cálculo que hizo (donde pudo tener <span class="math inline">\(10\)</span> ó <span class="math inline">\(5\)</span> para llegar a ese promedio de <span class="math inline">\(8\)</span> <em>pero no podemos saber de manera específica cuánto fue</em> ). Esto es igual: en promedio el estimador <span class="math inline">\(\hat{p}\)</span> será <span class="math inline">\(p\)</span> pero para un análisis específico <em>no sabemos</em>.</p>
<blockquote>
<p><strong>OJO</strong> Los datos observados no son variables aleatorias: esos ya son fijos, ya los viste. Los <em>posibles</em> datos observados sí son variables aleatorias ya que ellos, consisten en las variables que se <em>pudieron</em> haber observado y te permiten calcular las probabilidades de tus datos observados bajo algún modelo. En el caso de la moneda, los datos observados son <span class="math inline">\(\vec{x} = \big( \text{Sol}, \text{Sol},\text{Sol},\text{Sol},\text{Sol},\text{Sol},\text{Sol},\text{Sol},\text{Sol},\text{Sol},\text{Águila}\big)^T\)</span> pero los que se <em>pudieron</em> haber observado son todas las <span class="math inline">\(\binom{n}{2}\)</span> formas en las que la moneda pudo haber salido.</p>
</blockquote>
<p><strong>1. Estimación de una función de masa de probabilidad</strong>
Formalmente, para una variable aleatoria discreta <span class="math inline">\(X\)</span> que puede tomar los valores <span class="math inline">\(\{ a_1, a_2, \dots, a_{\ell} \}\)</span> de la cual se observaron <span class="math inline">\(n\)</span> realizaciones descritas mediante <span class="math inline">\(\vec{x} = (x_1, x_2, \dots, x_n)^T\)</span> (observados, fijos, constantes). Definimos la <strong>función de masa de probabilidad empírica</strong> como:
<span class="math display">\[
\hat{p}(x) = \begin{cases}
\\
\frac{1}{n} \sum_{i=1}^{n} \mathbb{I}_{\{a_1\}}(x_i) &amp; \text{ si } x = a_1 \\ \\
\frac{1}{n} \sum_{i=1}^{n} \mathbb{I}_{\{a_2\}}(x_i) &amp; \text{ si } x = a_2 \\ \\
\vdots \\ \\
\frac{1}{n} \sum_{i=1}^{n} \mathbb{I}_{\{a_{\ell}\}}(x_i) &amp; \text{ si } x = a_{\ell} \\
0 &amp; \text{ en otro caso}
\end{cases}
\]</span></p>
<p>donde se supone que <span class="math inline">\(\mathbb{P}(X = x) \approx \hat{p}(x)\)</span>. Notamos que lo anterior puede resumirse en:
<span class="math display">\[
\hat{p}(x) = \frac{1}{n} \sum_{i=1}^{n} \mathbb{I}_{\{ x\}}(x_i)
\]</span></p>
<p>Análogamente, nota que para un conjunto (medible) <span class="math inline">\(A\)</span>, la aproximación para <span class="math inline">\(\mathbb{P}(X \in A)\)</span> está dada por:</p>
<p><span class="math display">\[
\hat{p}(A) = \dfrac{1}{n}\sum\limits_{i=1}^{n} \mathbb{I}_A (x_i).
\]</span></p>
<p>Podemos graficar para la base de datos <code>conteo_delitos</code> la probabilidad de que, dado que se cometió un delito, éste haya ocurrido en el dia <span class="math inline">\(d_i\)</span> de diciembre. Para ello usamos un <code>geom_col</code>:</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="ajuste-funcional.html#cb142-1"></a><span class="kw">ggplot</span>(conteo_delitos) <span class="op">+</span></span>
<span id="cb142-2"><a href="ajuste-funcional.html#cb142-2"></a><span class="st">  </span><span class="kw">geom_col</span>(<span class="kw">aes</span>(<span class="dt">x =</span> fecha, <span class="dt">y =</span> n<span class="op">/</span><span class="kw">sum</span>(n), <span class="dt">fill =</span> n)) <span class="op">+</span></span>
<span id="cb142-3"><a href="ajuste-funcional.html#cb142-3"></a><span class="st">  </span><span class="kw">scale_fill_gradient</span>(<span class="st">&quot;Delito&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;orange&quot;</span>, <span class="dt">high =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></span>
<span id="cb142-4"><a href="ajuste-funcional.html#cb142-4"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb142-5"><a href="ajuste-funcional.html#cb142-5"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span></span>
<span id="cb142-6"><a href="ajuste-funcional.html#cb142-6"></a><span class="st">  </span><span class="kw">labs</span>(</span>
<span id="cb142-7"><a href="ajuste-funcional.html#cb142-7"></a>    <span class="dt">y =</span> <span class="st">&quot;p(x)&quot;</span>,</span>
<span id="cb142-8"><a href="ajuste-funcional.html#cb142-8"></a>    <span class="dt">x =</span> <span class="st">&quot;x&quot;</span>,</span>
<span id="cb142-9"><a href="ajuste-funcional.html#cb142-9"></a>    <span class="dt">title =</span> <span class="st">&quot;Aproximación a p(x)&quot;</span></span>
<span id="cb142-10"><a href="ajuste-funcional.html#cb142-10"></a>  )</span></code></pre></div>
<p><img src="Introduccion_a_Muestreo_files/figure-html/unnamed-chunk-119-1.png" width="672" /></p>
<p>Una propiedad interesante de la función de masa de probabilidad es que, en promedio, le atina al verdadero valor (lo que comentábamos antes de que <span class="math inline">\(\hat{p} = p\)</span>). Es decir, suponiendo que <span class="math inline">\(X\)</span> tiene una función de masa dada por:</p>
<p><span class="math display">\[
p(x) = \begin{cases}
p_1 &amp; \text{ si } x = a_1 \\
p_2 &amp; \text{ si } x = a_2 \\
\vdots \\
p_{\ell} &amp; \text{ si } x = a_{\ell} \\
\end{cases}
\]</span></p>
<p>y suponiendo un vector de muestras posibles <span class="math inline">\(\vec{X} = (X_1, X_2, \dots, X_n)^T\)</span> notamos que
<span class="math display">\[
\mathbb{I}_{\{ a_j \}}(X_i) \sim \text{Bernoulli} (p_j)
\]</span></p>
<p>Luego para cualquier <span class="math inline">\(x\)</span> se tiene que:</p>
<p><span class="math display">\[
\mathbb{E}\big[ \hat{p}(x)\big] = \mathbb{E}\bigg[ \dfrac{1}{n}\sum\limits_{i=1}^{n} \mathbb{I}_{\{ x \}}(X_i)  \bigg] = 
 \dfrac{1}{n}\sum\limits_{i=1}^{n}\mathbb{E}\big[ \mathbb{I}_{\{ x \}}(X_i)  \big] = \frac{1}{n} n \cdot p_j = p_j.
\]</span></p>
<p><strong>2. Función de distribución empírica</strong></p>
<p>Recuerda que para cualquier variable aleatoria <span class="math inline">\(X:\mathbb{R}\to\mathbb{R}\)</span> existe su función de distribución <span class="math inline">\(F_X\)</span> dada por:
<span class="math display">\[
F_X(x) = \mathbb{P}(X \leq x)
\]</span>
La idea de la función de distribución empírica es reconstruir (a partir de los datos observados) a <span class="math inline">\(F_X\)</span>. Para ello, notamos que queremos estimar
<span class="math display">\[
\mathbb{P}(X \leq x) \qquad \forall x\in\mathbb{R}
\]</span>
esto es equivalente a estimar:
<span class="math display">\[
\mathbb{P}\big(X \in (-\infty, x] \big)
\]</span>
y podemos aplicar la aproximación que usamos arriba para un conjunto <span class="math inline">\(A\)</span>:
<span class="math display">\[
\mathbb{P}\big(X \in (-\infty, x] \big) \approx \sum\limits_{i=1}^n \mathbb{I}_{(-\infty, x]}(x_i)
\]</span></p>
<p>La función de distribución empírica está definida para un vector numérico <span class="math inline">\(\vec{x} = (x_1, x_2, \dots, x_n)^T\)</span> por:
<span class="math display">\[
\hat{F} (x) = \frac{1}{n} \sum\limits_{i=1}^{n} \mathbb{I}_{(-\infty, x]}(x_i)
\]</span></p>
<p>La función de distribución empírica es una función de distribución pues cumple las siguientes propiedades (demuéstralo):</p>
<ol style="list-style-type: decimal">
<li><p><span class="math inline">\(\lim_{x \to -\infty} \hat{F}(x) = 0\)</span></p></li>
<li><p><span class="math inline">\(\lim_{x \to \infty} \hat{F}(x) = 1\)</span></p></li>
<li><p>Si <span class="math inline">\(x &lt; y\)</span> entonces <span class="math inline">\(\hat{F}(x) \leq \hat{F}(y)\)</span> (no decreciente)</p></li>
<li><p><span class="math inline">\(\hat{F}\)</span> es continua por la derecha con límites por la izquierda (càdlàg).</p></li>
</ol>
<p>Para demostrar 4. basta con demostrar que para <span class="math inline">\(x_i\)</span> fija, la función <span class="math inline">\(i(x) = \mathbb{I}_{(-\infty, x]}(x_i)\)</span> es continua por la derecha con límites por la izquierda pues <span class="math inline">\(\hat{F}(x)\)</span> es una suma de dichas funciones.</p>
<p>En particular, podemos notar que la función de distribución empírica <span class="math inline">\(\hat{F} (x)\)</span> le atina a la función de distribución; es decir:</p>
<p><span class="math display">\[
\mathbb{E}\big[\hat{F} (x) \big] = F(x) 
\]</span></p>
<p>Para ello consideramos un vector de valores posibles <span class="math inline">\(\vec{X} = (X_1, X_2, \dots, X_n)^T\)</span> donde las <span class="math inline">\(X_i\)</span> tienen la misma distribución que <span class="math inline">\(X\)</span>. Y notamos que:
<span class="math display">\[
\mathbb{I}_{(-\infty, x]}(X_i) \sim \textrm{Bernoulli}\big(F(x)\big)
\]</span>
pues <span class="math inline">\(\mathbb{I}_{(-\infty, x]}(X_i) = 1\)</span> si <span class="math inline">\(X_i \leq x\)</span> y <span class="math inline">\(\mathbb{I}_{(-\infty, x]}(X_i) = 0\)</span> si <span class="math inline">\(X_i &gt; x\)</span>. Luego:
<span class="math display">\[
\mathbb{P}\Big( \mathbb{I}_{(-\infty, x]}(X_i) = 1 \Big) = \mathbb{P}(X_i \leq x) = \mathbb{P}(X\leq x) = F(x)
\]</span></p>
<p>donde la igualdad del medio se sigue de que <span class="math inline">\(X_i\)</span> y <span class="math inline">\(X\)</span> tienen la misma distribución. Entonces:
<span class="math display">\[
\mathbb{E}\big[ \hat{F}(x) \big] = \mathbb{E}\Big[ \dfrac{1}{n} \sum\limits_{i=1}^{n} \mathbb{I}_{(-\infty, x]}(X_i) \Big] = \dfrac{1}{n}\sum\limits_{i=1}^{n} \mathbb{E}\big[  \mathbb{I}_{(-\infty, x]}(X_i)\big] = \dfrac{1}{n} n \cdot F(x) = F(x)
\]</span></p>
<p>En <code>R</code> podemos calcular la función de distribución empírica con el comando <code>ecdf</code> el cual cuenta la cantidad de observaciones y regresa una función. Así, para la base de datos <code>conteo_delitos</code> podemos calcular la función de distribución empírica <code>ecdf</code> asociada a la cantidad de delitos que se cometen en un día mediante:</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="ajuste-funcional.html#cb143-1"></a>Fgorro &lt;-<span class="st"> </span><span class="kw">ecdf</span>(conteo_delitos<span class="op">$</span>n)</span></code></pre></div>
<p>De esta forma podemos calcular la probabilidad de que en un día se cometan menos de 500 delitos:</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="ajuste-funcional.html#cb144-1"></a><span class="kw">Fgorro</span>(<span class="dv">500</span>)</span></code></pre></div>
<pre><code>## [1] 0.09677419</code></pre>
<p>O bien podemos graficar la función:</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="ajuste-funcional.html#cb146-1"></a>x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">300</span>, <span class="dv">1000</span>, <span class="dt">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb146-2"><a href="ajuste-funcional.html#cb146-2"></a>y &lt;-<span class="st"> </span><span class="kw">Fgorro</span>(x)</span>
<span id="cb146-3"><a href="ajuste-funcional.html#cb146-3"></a><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb146-4"><a href="ajuste-funcional.html#cb146-4"></a><span class="st">  </span><span class="kw">geom_step</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y), <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></span>
<span id="cb146-5"><a href="ajuste-funcional.html#cb146-5"></a><span class="st">  </span><span class="kw">labs</span>(</span>
<span id="cb146-6"><a href="ajuste-funcional.html#cb146-6"></a>    <span class="dt">x =</span> <span class="st">&quot;Número de carpetas de investigación (x)&quot;</span>,</span>
<span id="cb146-7"><a href="ajuste-funcional.html#cb146-7"></a>    <span class="dt">y =</span> <span class="st">&quot;Probabilidad de que en un día</span><span class="ch">\n</span><span class="st">se abran menos de x carpetas&quot;</span>,</span>
<span id="cb146-8"><a href="ajuste-funcional.html#cb146-8"></a>    <span class="dt">title =</span> <span class="st">&quot;Distribución acumulada de carpetas de investigación en CDMX&quot;</span></span>
<span id="cb146-9"><a href="ajuste-funcional.html#cb146-9"></a>  ) <span class="op">+</span></span>
<span id="cb146-10"><a href="ajuste-funcional.html#cb146-10"></a><span class="st">  </span><span class="kw">theme_minimal</span>()</span></code></pre></div>
<p><img src="Introduccion_a_Muestreo_files/figure-html/unnamed-chunk-122-1.png" width="672" /></p>
<p>Mediante simulaciones, podemos observar que <span class="math inline">\(\hat{F}\)</span> realmente le atina a <span class="math inline">\(F\)</span> como sigue:</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="ajuste-funcional.html#cb147-1"></a><span class="co">#Cantidad de simulaciones</span></span>
<span id="cb147-2"><a href="ajuste-funcional.html#cb147-2"></a>nsim       &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb147-3"><a href="ajuste-funcional.html#cb147-3"></a></span>
<span id="cb147-4"><a href="ajuste-funcional.html#cb147-4"></a><span class="co">#Tamaño de la muestra en cada simulacion</span></span>
<span id="cb147-5"><a href="ajuste-funcional.html#cb147-5"></a>n_muestra  &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb147-6"><a href="ajuste-funcional.html#cb147-6"></a></span>
<span id="cb147-7"><a href="ajuste-funcional.html#cb147-7"></a><span class="co">#Valores a evaluar la función</span></span>
<span id="cb147-8"><a href="ajuste-funcional.html#cb147-8"></a>x          &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="dt">length.out =</span> <span class="dv">200</span>)</span>
<span id="cb147-9"><a href="ajuste-funcional.html#cb147-9"></a></span>
<span id="cb147-10"><a href="ajuste-funcional.html#cb147-10"></a><span class="co">#Base de datos para guardar resultados de simulaciones</span></span>
<span id="cb147-11"><a href="ajuste-funcional.html#cb147-11"></a>F_simulado &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">matrix</span>(<span class="ot">NA</span>, <span class="dt">ncol =</span> nsim, <span class="dt">nrow =</span> <span class="kw">length</span>(x)))</span>
<span id="cb147-12"><a href="ajuste-funcional.html#cb147-12"></a></span>
<span id="cb147-13"><a href="ajuste-funcional.html#cb147-13"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nsim){</span>
<span id="cb147-14"><a href="ajuste-funcional.html#cb147-14"></a>  valores_simulados &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n_muestra)</span>
<span id="cb147-15"><a href="ajuste-funcional.html#cb147-15"></a>  F_empirica        &lt;-<span class="st"> </span><span class="kw">ecdf</span>(valores_simulados)</span>
<span id="cb147-16"><a href="ajuste-funcional.html#cb147-16"></a>  F_simulado[,i]    &lt;-<span class="st"> </span><span class="kw">F_empirica</span>(x)</span>
<span id="cb147-17"><a href="ajuste-funcional.html#cb147-17"></a>}</span>
<span id="cb147-18"><a href="ajuste-funcional.html#cb147-18"></a></span>
<span id="cb147-19"><a href="ajuste-funcional.html#cb147-19"></a>F_simulado<span class="op">$</span>Valor_x &lt;-<span class="st"> </span>x</span>
<span id="cb147-20"><a href="ajuste-funcional.html#cb147-20"></a></span>
<span id="cb147-21"><a href="ajuste-funcional.html#cb147-21"></a><span class="co">#Cambiamos el formato de la base para graficar</span></span>
<span id="cb147-22"><a href="ajuste-funcional.html#cb147-22"></a>F_simulado &lt;-<span class="st"> </span>F_simulado <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="op">-</span>Valor_x)</span>
<span id="cb147-23"><a href="ajuste-funcional.html#cb147-23"></a></span>
<span id="cb147-24"><a href="ajuste-funcional.html#cb147-24"></a><span class="kw">ggplot</span>(F_simulado) <span class="op">+</span></span>
<span id="cb147-25"><a href="ajuste-funcional.html#cb147-25"></a><span class="st">  </span><span class="kw">geom_step</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Valor_x, <span class="dt">y =</span> value, <span class="dt">color =</span> name), <span class="dt">alpha =</span> <span class="fl">0.1</span>) <span class="op">+</span></span>
<span id="cb147-26"><a href="ajuste-funcional.html#cb147-26"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Valor_x, <span class="dt">y =</span> <span class="kw">pnorm</span>(Valor_x)), <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb147-27"><a href="ajuste-funcional.html#cb147-27"></a><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span></span>
<span id="cb147-28"><a href="ajuste-funcional.html#cb147-28"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span></span>
<span id="cb147-29"><a href="ajuste-funcional.html#cb147-29"></a><span class="st">  </span><span class="kw">labs</span>(</span>
<span id="cb147-30"><a href="ajuste-funcional.html#cb147-30"></a>    <span class="dt">x =</span> <span class="st">&quot;x&quot;</span>,</span>
<span id="cb147-31"><a href="ajuste-funcional.html#cb147-31"></a>    <span class="dt">y =</span> <span class="st">&quot;F(x)&quot;</span>,</span>
<span id="cb147-32"><a href="ajuste-funcional.html#cb147-32"></a>    <span class="dt">title =</span> <span class="st">&quot;Simulaciones de funciones de distribuciones acumuladas empíricas&quot;</span>,</span>
<span id="cb147-33"><a href="ajuste-funcional.html#cb147-33"></a>    <span class="dt">subtitle =</span> <span class="st">&quot;Para X ~ Normal(0,1)&quot;</span></span>
<span id="cb147-34"><a href="ajuste-funcional.html#cb147-34"></a>  )</span></code></pre></div>
<p><img src="Introduccion_a_Muestreo_files/figure-html/unnamed-chunk-123-1.png" width="672" /></p>
<p><strong>2. Histograma</strong>
Para una variable aleatoria continua, la aproximación <span class="math inline">\(\hat{p}\)</span> que hicimos no funciona (la masa siempre es <span class="math inline">\(0\)</span>). Por lo que es necesario analizar alternativas para estudiar la densidad si suponemos que los datos pueden modelarse mediante algo continuo. Para construir un histograma consideremos <span class="math inline">\(\vec{x} = (x_1, x_2, \dots, x_n)^T\)</span> y una constante <span class="math inline">\(h &gt; 0\)</span> llamada el <strong>ancho de banda (binwidth)</strong>. Sea <span class="math inline">\(\{ I_j \}\)</span> una colección de intervalos no vacíos de <span class="math inline">\(\mathbb{R}\)</span> tal que <span class="math inline">\(\cup_{j=1} I_j = \mathbb{R}\)</span> e <span class="math inline">\(I_j \cap I_k = \emptyset\)</span> (<em>i.e.</em> los <span class="math inline">\(\{ I_j \}\)</span> forman una partición de <span class="math inline">\(\mathbb{R}\)</span>). Supongamos, además, los <span class="math inline">\(I_j\)</span> son de la forma:
<span class="math display">\[
I_j = \Big[\kappa + (j-1) h, \kappa + jh  \Big)
\]</span>
para algún <span class="math inline">\(\kappa \in \mathbb{R}\)</span> fijo. Sea
<span class="math display">\[
n_j(\vec{x}) = \sum\limits_{i=1}^n \mathbb{I}_{I_j}(x_i)
\]</span>
la cantidad de <span class="math inline">\(x_i\)</span> en el intervalo <span class="math inline">\(I_j\)</span>.</p>
<p>Un histograma es la gráfica de la función:
<span class="math display">\[
\text{hist}_{\vec{x}}(x) = \frac{1}{n \cdot h} \sum\limits_{j} n_j(\vec{x}) \cdot \mathbb{I}_{I_j}(x)
\]</span></p>
<p>Una propiedad interesante de un histograma es que éste aproxima correctamente las probabilidades <span class="math inline">\(\mathbb{P}(X \in I_j)\)</span>. Para ver esto, consideramos un vector de valores posibles <span class="math inline">\(\vec{X} = (X_1, X_2, \dots, X_n)^T\)</span> y que <span class="math inline">\(x\in I_j\)</span>, luego:</p>
<p><span class="math display">\[
\mathbb{E}\Big[ \int_{I_j} \text{hist}_{\vec{X}}(x) dx \Big] = \mathbb{E}\bigg[ \frac{1}{n \cdot h} \sum\limits_{j} n_j(\vec{X}) \cdot \int_{I_j} \mathbb{I}_{I_j}(x) dx \bigg] =  \frac{1}{n \cdot h} \sum\limits_{j} \mathbb{E}\big[ n_j(\vec{X}) \big] \cdot h  = \dfrac{1}{n}\sum\limits_{j} \mathbb{E}\big[ n_j(\vec{X}) \big]
\]</span>
donde las <span class="math inline">\(n_j(\vec{X})\)</span> son variables aleatorias en este caso y:
<span class="math display">\[
\mathbb{E}\big[ n_j(\vec{X})\big] = \sum\limits_{i=1}^n \mathbb{E}\big[\mathbb{I}_{I_j}(X_i)\big] = \sum\limits_{i=1}^n\mathbb{P}(X_i \in I_j) = n \mathbb{P}(X \in I_j)
\]</span>
donde la última igualdad se da pues las <span class="math inline">\(X_i\)</span> tienen la misma distribución que <span class="math inline">\(X\)</span>. Luego:
<span class="math display">\[
\mathbb{E}\Big[ \int_{I_j} \text{hist}_{\vec{X}}(x) dx \Big] = \mathbb{P}(X \in I_j)
\]</span>
Es decir, el valor esperado del área bajo un histograma en un intervalo <span class="math inline">\(I_j\)</span> coincide con la probabilidad de que <span class="math inline">\(X\)</span> pertenezca a dicho intervalo.</p>
<p>Gráficamente:</p>
<p><img src="Introduccion_a_Muestreo_files/figure-html/unnamed-chunk-124-1.png" width="672" />
En <code>R</code> podemos hacer un histograma a través de <code>geom_histogram</code>. En este caso lo haremos de la latitud:</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="ajuste-funcional.html#cb148-1"></a><span class="co">#En este caso binwidth = h y kappa = boundary</span></span>
<span id="cb148-2"><a href="ajuste-funcional.html#cb148-2"></a><span class="kw">ggplot</span>(datos) <span class="op">+</span></span>
<span id="cb148-3"><a href="ajuste-funcional.html#cb148-3"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">x =</span> latitud, <span class="dt">y =</span> ..density..), </span>
<span id="cb148-4"><a href="ajuste-funcional.html#cb148-4"></a>                 <span class="dt">binwidth =</span> <span class="fl">0.02</span>, <span class="dt">boundary =</span> <span class="dv">-99</span>,</span>
<span id="cb148-5"><a href="ajuste-funcional.html#cb148-5"></a>                 <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;purple&quot;</span>) <span class="op">+</span></span>
<span id="cb148-6"><a href="ajuste-funcional.html#cb148-6"></a><span class="st">  </span><span class="kw">theme_light</span>() </span></code></pre></div>
<p><img src="Introduccion_a_Muestreo_files/figure-html/unnamed-chunk-125-1.png" width="672" /></p>
<div id="ejercicio-3" class="section level3">
<h3><span class="header-section-number">2.1.1</span> Ejercicio</h3>
<p>Considera la siguiente base de datos:</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="ajuste-funcional.html#cb149-1"></a>mis.datos &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb149-2"><a href="ajuste-funcional.html#cb149-2"></a>  <span class="dt">A =</span>  <span class="kw">c</span>(<span class="fl">3.15</span>, <span class="fl">5.46</span>, <span class="fl">3.28</span>, <span class="fl">4.20</span>, <span class="fl">1.98</span>, <span class="fl">2.28</span>, <span class="fl">3.12</span>, <span class="fl">4.10</span>, <span class="fl">3.42</span>, <span class="fl">3.91</span>, </span>
<span id="cb149-3"><a href="ajuste-funcional.html#cb149-3"></a>         <span class="fl">2.06</span>, <span class="fl">5.53</span>, <span class="fl">5.19</span>, <span class="fl">2.39</span>, <span class="fl">1.88</span>, <span class="fl">3.43</span>, <span class="fl">5.51</span>, <span class="fl">2.54</span>, <span class="fl">3.64</span>, <span class="fl">4.33</span>, </span>
<span id="cb149-4"><a href="ajuste-funcional.html#cb149-4"></a>         <span class="fl">4.85</span>, <span class="fl">5.56</span>, <span class="fl">1.89</span>, <span class="fl">4.84</span>, <span class="fl">5.74</span>, <span class="fl">3.22</span>, <span class="fl">5.52</span>, <span class="fl">1.84</span>, <span class="fl">4.31</span>, <span class="fl">2.01</span>, </span>
<span id="cb149-5"><a href="ajuste-funcional.html#cb149-5"></a>         <span class="fl">4.01</span>, <span class="fl">5.31</span>, <span class="fl">2.56</span>, <span class="fl">5.11</span>, <span class="fl">2.58</span>, <span class="fl">4.43</span>, <span class="fl">4.96</span>, <span class="fl">1.90</span>, <span class="fl">5.60</span>, <span class="fl">1.92</span>),</span>
<span id="cb149-6"><a href="ajuste-funcional.html#cb149-6"></a>  <span class="dt">B =</span>  <span class="kw">c</span>(<span class="fl">2.90</span>, <span class="fl">5.21</span>, <span class="fl">3.03</span>, <span class="fl">3.95</span>, <span class="fl">1.73</span>, <span class="fl">2.03</span>, <span class="fl">2.87</span>, <span class="fl">3.85</span>, <span class="fl">3.17</span>, <span class="fl">3.66</span>,</span>
<span id="cb149-7"><a href="ajuste-funcional.html#cb149-7"></a>         <span class="fl">1.81</span>, <span class="fl">5.28</span>, <span class="fl">4.94</span>, <span class="fl">2.14</span>, <span class="fl">1.63</span>, <span class="fl">3.18</span>, <span class="fl">5.26</span>, <span class="fl">2.29</span>, <span class="fl">3.39</span>, <span class="fl">4.08</span>,</span>
<span id="cb149-8"><a href="ajuste-funcional.html#cb149-8"></a>         <span class="fl">4.60</span>, <span class="fl">5.31</span>, <span class="fl">1.64</span>, <span class="fl">4.59</span>, <span class="fl">5.49</span>, <span class="fl">2.97</span>, <span class="fl">5.27</span>, <span class="fl">1.59</span>, <span class="fl">4.06</span>, <span class="fl">1.76</span>, </span>
<span id="cb149-9"><a href="ajuste-funcional.html#cb149-9"></a>         <span class="fl">3.76</span>, <span class="fl">5.06</span>, <span class="fl">2.31</span>, <span class="fl">4.86</span>, <span class="fl">2.33</span>, <span class="fl">4.18</span>, <span class="fl">4.71</span>, <span class="fl">1.65</span>, <span class="fl">5.35</span>, <span class="fl">1.67</span>),</span>
<span id="cb149-10"><a href="ajuste-funcional.html#cb149-10"></a>  <span class="dt">C =</span>  <span class="kw">c</span>(<span class="fl">2.65</span>, <span class="fl">4.96</span>, <span class="fl">2.78</span>, <span class="fl">3.70</span>, <span class="fl">1.48</span>, <span class="fl">1.78</span>, <span class="fl">2.62</span>, <span class="fl">3.60</span>, <span class="fl">2.92</span>, <span class="fl">3.41</span>,</span>
<span id="cb149-11"><a href="ajuste-funcional.html#cb149-11"></a>         <span class="fl">1.56</span>, <span class="fl">5.03</span>, <span class="fl">4.69</span>, <span class="fl">1.89</span>, <span class="fl">1.38</span>, <span class="fl">2.93</span>, <span class="fl">5.01</span>, <span class="fl">2.04</span>, <span class="fl">3.14</span>, <span class="fl">3.83</span>,</span>
<span id="cb149-12"><a href="ajuste-funcional.html#cb149-12"></a>         <span class="fl">4.35</span>, <span class="fl">5.06</span>, <span class="fl">1.39</span>, <span class="fl">4.34</span>, <span class="fl">5.24</span>, <span class="fl">2.72</span>, <span class="fl">5.02</span>, <span class="fl">1.34</span>, <span class="fl">3.81</span>, <span class="fl">1.51</span>, </span>
<span id="cb149-13"><a href="ajuste-funcional.html#cb149-13"></a>         <span class="fl">3.51</span>, <span class="fl">4.81</span>, <span class="fl">2.06</span>, <span class="fl">4.61</span>, <span class="fl">2.08</span>, <span class="fl">3.93</span>, <span class="fl">4.46</span>, <span class="fl">1.4</span>, <span class="fl">5.1</span>, <span class="fl">1.42</span>),</span>
<span id="cb149-14"><a href="ajuste-funcional.html#cb149-14"></a>  <span class="dt">D =</span>  <span class="kw">c</span>(<span class="fl">2.40</span>, <span class="fl">4.71</span>, <span class="fl">2.53</span>, <span class="fl">3.45</span>, <span class="fl">1.23</span>, <span class="fl">1.53</span>, <span class="fl">2.37</span>, <span class="fl">3.35</span>, <span class="fl">2.67</span>, <span class="fl">3.16</span>,</span>
<span id="cb149-15"><a href="ajuste-funcional.html#cb149-15"></a>         <span class="fl">1.31</span>, <span class="fl">4.78</span>, <span class="fl">4.44</span>, <span class="fl">1.64</span>, <span class="fl">1.13</span>, <span class="fl">2.68</span>, <span class="fl">4.76</span>, <span class="fl">1.79</span>, <span class="fl">2.89</span>, <span class="fl">3.58</span>,</span>
<span id="cb149-16"><a href="ajuste-funcional.html#cb149-16"></a>         <span class="fl">4.10</span>, <span class="fl">4.81</span>, <span class="fl">1.14</span>, <span class="fl">4.09</span>, <span class="fl">4.99</span>, <span class="fl">2.47</span>, <span class="fl">4.77</span>, <span class="fl">1.09</span>, <span class="fl">3.56</span>, <span class="fl">1.26</span>, </span>
<span id="cb149-17"><a href="ajuste-funcional.html#cb149-17"></a>         <span class="fl">3.26</span>, <span class="fl">4.56</span>, <span class="fl">1.81</span>, <span class="fl">4.36</span>, <span class="fl">1.83</span>, <span class="fl">3.68</span>, <span class="fl">4.21</span>, <span class="fl">1.15</span>, <span class="fl">4.85</span>, <span class="fl">1.17</span>)</span>
<span id="cb149-18"><a href="ajuste-funcional.html#cb149-18"></a>)</span></code></pre></div>
<p>Grafica un histograma de las variables <code>A</code>, <code>B</code>, <code>C</code> y <code>D</code> de dicha base con un ancho de banda (binwidth) igual a <code>1</code>.</p>
<ol style="list-style-type: lower-alpha">
<li><p>¿Podemos concluir la forma de la distribución a partir del histograma? Es decir ¿hay distribuciones sesgadas a la izquierda, a la derecha, uniformes, centradas o con colas pesadas?</p></li>
<li><p>Realiza el mismo histograma pero ahora con un ancho de banda de 0.25 ¿por qué hubo cambios?</p></li>
<li><p>Analiza la base de datos (los valores en función de la columna A) y concluye.</p></li>
</ol>
<p><strong>3. Densidad kernel</strong>
Un histograma tiene muchos bemoles: en particular, es necesario decidir quién es <span class="math inline">\(h\)</span> y quién <span class="math inline">\(\kappa\)</span> y no hay una regla clara de cómo hacerlo. La densidad <code>kernel</code> es un intento de mejorar esta situación. Para ello recordamos que si <span class="math inline">\(X\)</span> es una variable aleatoria continua con densidad <span class="math inline">\(F\)</span> entonces:
<span class="math display">\[
f(x) = F&#39;(x) = \lim_{h \to 0} \dfrac{F(x + h) - F(x - h)}{2h}
\]</span>
Por lo que para un <span class="math inline">\(h\)</span> positiva con <span class="math inline">\(h \approx 0\)</span> tenemos que:
<span class="math display">\[
f(x) \approx \dfrac{F(x + h) - F(x - h)}{2h} 
\]</span>
En el caso de un vector de observaciones <span class="math inline">\(\vec{x} = (x_1, x_2, \dots, x_n)^T\)</span> recordamos que podemos asociar una función de distribución empírica <span class="math inline">\(\hat{F}\)</span> y por tanto obtener el <em>estimador de Rosenblatt</em> de la densidad <span class="math inline">\(f\)</span> mediante:
<span class="math display">\[
\hat{f}(x) =  \dfrac{\hat{F}(x + h) -\hat{F}(x - h)}{2h} 
\]</span>
Podemos reescribir esto como:
<span class="math display">\[
\hat{f}(x) =  \dfrac{1}{2nh} \sum\limits_{i = 1}^n \mathbb{I}_{(x-h, x+h]}(x_i) = \dfrac{1}{nh}\sum\limits_{i = 1}^n K\Big( \frac{x_i - x}{h}\Big)
\]</span>
donde:
<span class="math display">\[
K(u) = \frac{1}{2} \mathbb{I}_{(-1, 1]}(u)
\]</span></p>
<p>se conoce como el <em>kernel rectangular</em>. Una vez que llegamos hasta este punto notamos que para cualquier <span class="math inline">\(K\)</span> que cumple:</p>
<ol style="list-style-type: decimal">
<li><p><span class="math inline">\(\int\limits_{-\infty}^{\infty} K(u) du = 1\)</span></p></li>
<li><p><span class="math inline">\(K(u) \geq 0\)</span></p></li>
</ol>
<p>la función <span class="math inline">\(\hat{f}\)</span> es una función de densidad. La función <span class="math inline">\(\hat{f}\)</span> se conoce como el <em>estimador de densidad del kernel K</em>. Algunos ejemplos de kernels <span class="math inline">\(K\)</span> son:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Rectangular:</strong> <span class="math inline">\(K(u) = \frac{1}{2} \mathbb{I}_{(-1, 1]}(u)\)</span></p></li>
<li><p><strong>Triangular:</strong> <span class="math inline">\(K(u) = (1 - |u|) \mathbb{I}_{(-1, 1]}(u)\)</span></p></li>
<li><p><strong>Epanechnikov:</strong> <span class="math inline">\(K(u) = \frac{3}{4}(1 - u^2) \mathbb{I}_{(-1, 1]}(u)\)</span></p></li>
<li><p><strong>Gaussiano:</strong> <span class="math inline">\(K(u) = \frac{1}{\sqrt{2\pi}}\text{exp}(-u^2/2)\)</span></p></li>
</ol>
<blockquote>
<p><strong>OJO</strong> No confundir el Kernel <span class="math inline">\(K\)</span> (que es una función que integra a <span class="math inline">\(1\)</span>) con <em>función de densidad kernel</em> que es una función de los datos que utiliza un kernel y es una densidad por sí misma.</p>
</blockquote>
<p>En <code>R</code> podemos calcular la densidad <code>kernel</code> en <code>n</code> puntos con relativa facilidad mediante <code>density</code>:</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="ajuste-funcional.html#cb150-1"></a>densidad_kernel &lt;-<span class="st"> </span><span class="kw">density</span>(datos<span class="op">$</span>latitud, <span class="dt">kernel =</span> <span class="st">&quot;gaussian&quot;</span>, <span class="dt">n =</span> <span class="dv">700</span>,</span>
<span id="cb150-2"><a href="ajuste-funcional.html#cb150-2"></a>                           <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p>Nota que <code>R</code> en automático preselecciona los valores de <code>h</code> mediante un criterio preprogramado de optimización. Podemos ver dicha densidad gráficamente (y compararla con un histograma):</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="ajuste-funcional.html#cb151-1"></a><span class="kw">ggplot</span>(datos) <span class="op">+</span></span>
<span id="cb151-2"><a href="ajuste-funcional.html#cb151-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">x =</span> latitud, <span class="dt">y =</span> ..density..), </span>
<span id="cb151-3"><a href="ajuste-funcional.html#cb151-3"></a>                 <span class="dt">binwidth =</span> <span class="fl">0.01</span>, <span class="dt">boundary =</span> <span class="dv">19</span>,</span>
<span id="cb151-4"><a href="ajuste-funcional.html#cb151-4"></a>                 <span class="dt">fill =</span> <span class="st">&quot;purple&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></span>
<span id="cb151-5"><a href="ajuste-funcional.html#cb151-5"></a><span class="st">  </span><span class="kw">geom_density</span>(<span class="kw">aes</span>(<span class="dt">x =</span> latitud), <span class="dt">kernel =</span> <span class="st">&quot;gaussian&quot;</span>, <span class="dt">size =</span> <span class="fl">1.5</span>) <span class="op">+</span></span>
<span id="cb151-6"><a href="ajuste-funcional.html#cb151-6"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="Introduccion_a_Muestreo_files/figure-html/unnamed-chunk-128-1.png" width="672" /></p>
<p>Esto no se queda ahí, podemos generalizar el concepto de kernel a dos dimensiones para aproximar una función de densidad <span class="math inline">\(f(x,y)\)</span> de dos variables aleatorias sí tenemos dos vectores <span class="math inline">\(\vec{x}\)</span> y <span class="math inline">\(\vec{y}\)</span> y calculamos:</p>
<p><span class="math display">\[
\hat{f}(x,y) =\dfrac{1}{nh^2} \sum\limits_{i = 1}^n K \Big( \frac{x_i - x}{h}\Big) K \Big( \frac{y_i - y}{h}\Big)
\]</span></p>
<p>En particular esto nos permite generar una densidad en <code>R</code> para saber en qué coordenadas de latitud y longitud ocurren más los delitos:</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="ajuste-funcional.html#cb152-1"></a><span class="kw">ggplot</span>(datos) <span class="op">+</span></span>
<span id="cb152-2"><a href="ajuste-funcional.html#cb152-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> longitud, <span class="dt">y =</span> latitud), <span class="dt">alpha =</span> <span class="fl">0.025</span>) <span class="op">+</span></span>
<span id="cb152-3"><a href="ajuste-funcional.html#cb152-3"></a><span class="st">  </span><span class="kw">geom_density_2d_filled</span>(<span class="kw">aes</span>(<span class="dt">x =</span> longitud, <span class="dt">y =</span> latitud), <span class="dt">alpha =</span> <span class="fl">0.75</span>) <span class="op">+</span></span>
<span id="cb152-4"><a href="ajuste-funcional.html#cb152-4"></a><span class="st">  </span><span class="kw">geom_density2d</span>(<span class="kw">aes</span>(<span class="dt">x =</span> longitud, <span class="dt">y =</span> latitud)) <span class="op">+</span></span>
<span id="cb152-5"><a href="ajuste-funcional.html#cb152-5"></a><span class="st">  </span><span class="kw">theme_void</span>()</span></code></pre></div>
<p><img src="Introduccion_a_Muestreo_files/figure-html/unnamed-chunk-129-1.png" width="672" /></p>
</div>
<div id="ejercicio-sugerido" class="section level3">
<h3><span class="header-section-number">2.1.2</span> Ejercicio sugerido</h3>
<p>Este ejercicio es para que tengas la seguridad de que comprendiste los conceptos previos y sabes calcularlos. Es tedioso pero bueno para aclarar dudas.</p>
Considera la siguiente base de datos:
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
x
</th>
<th style="text-align:right;">
y
</th>
<th style="text-align:left;">
z
</th>
<th style="text-align:left;">
w
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-100
</td>
<td style="text-align:left;">
Rojo
</td>
<td style="text-align:left;">
Bueno
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
-2
</td>
<td style="text-align:left;">
Azul
</td>
<td style="text-align:left;">
Malo
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Azul
</td>
<td style="text-align:left;">
Regular
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
Rojo
</td>
<td style="text-align:left;">
Bueno
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Verde
</td>
<td style="text-align:left;">
Bueno
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
Amarillo
</td>
<td style="text-align:left;">
Malo
</td>
</tr>
</tbody>
</table>
<p>Calcula <strong>a mano</strong> (es decir puedes usar calculadora pero no lo calcules en <code>R</code>) y luego <strong>verifica tus cálculos haciéndolo en <code>R</code></strong>:</p>
<ol style="list-style-type: decimal">
<li><p>El total de <span class="math inline">\(\vec{x}\)</span></p></li>
<li><p>La media y varianza de <span class="math inline">\(\vec{y}\)</span></p></li>
<li><p>La curtosis y la asimetría de <span class="math inline">\(\vec{x}\)</span> (su media es 2 y su varianza 0.8). Determina si tiene un sesgo a la derecha, a la izquierda o ninguno.</p></li>
<li><p>Determina mediante la curtosis si <span class="math inline">\(\vec{x}\)</span> tiene colas más pesadas que <span class="math inline">\(\vec{y}\)</span>.</p></li>
<li><p>Calcula el cuantil <span class="math inline">\(0.25\)</span> y el <span class="math inline">\(0.75\)</span> de <span class="math inline">\(\vec{y}\)</span> así como su rango intercuartílico (IQR).</p></li>
<li><p>¿Hay valores atípicos (<em>outliers</em>) en <span class="math inline">\(\vec{y}\)</span>? En caso afirmativo, determina cuáles son.</p></li>
<li><p>¿Cuál es el rango de <span class="math inline">\(\vec{y}\)</span>? (no confundir con el IQR).</p></li>
<li><p>Determina la moda de <span class="math inline">\(\vec{z}\)</span></p></li>
<li><p>Determina la mediana de <span class="math inline">\(\vec{x}\)</span>.</p></li>
<li><p>Determina la MAD de <span class="math inline">\(\vec{x}\)</span></p></li>
<li><p>Realiza el conteo de cuáles <span class="math inline">\(\vec{z}\)</span> pertenecen al conjunto <span class="math inline">\(A = \{ \text{Rojo}, \text{Amarillo} \}\)</span></p></li>
<li><p>Realiza una tabla de contingencia de <span class="math inline">\(\vec{w}\)</span> y <span class="math inline">\(\vec{z}\)</span>.</p></li>
<li><p>Determina la distribución frecuencial (observada) marginal de <span class="math inline">\(\vec{w}\)</span>.</p></li>
<li><p>Realiza una tabla de frecuencias de <span class="math inline">\(\vec{w}\)</span> y <span class="math inline">\(\vec{z}\)</span>.</p></li>
<li><p>Calcula el riesgo relativo de estar en un choque dado que manejas en CDMX a partir de los datos en la tabla :</p></li>
</ol>

<p>Interpreta tu resultado.</p>
<ol start="16" style="list-style-type: decimal">
<li><p>De la tabla anterior calcula la razón de momios asociada a chocar dado que manejas en CDMX. Interprétala.</p></li>
<li><p>Calcula la correlación de Bravais Pearson de <span class="math inline">\(\vec{x}\)</span> y <span class="math inline">\(\vec{y}\)</span>. Interpreta.</p></li>
<li><p>Obtén la correlación de Spearman de <span class="math inline">\(\vec{x}\)</span> y <span class="math inline">\(\vec{y}\)</span></p></li>
<li><p>Para <span class="math inline">\(\vec{w}\)</span> y <span class="math inline">\(\vec{x}\)</span> obtén la <span class="math inline">\(\tau\)</span> de Kendall (son 15 comparaciones para generarla)</p></li>
<li><p>Descartando el <em>outlier</em> de <span class="math inline">\(\vec{y}\)</span> (y su <span class="math inline">\(\vec{x}\)</span> asociada), ajusta un modelo lineal <span class="math inline">\(\hat{y} = \hat{\beta}_1 x + \hat{\beta}_0\)</span> y grafícalo para ver qué tan buen modelo es.</p></li>
<li><p>Realiza una gráfica de caja (boxplot) para <span class="math inline">\(\vec{y}\)</span></p></li>
<li><p>Realiza un scatterplot para la submatriz <span class="math inline">\(Z_{(x,y)}\)</span>.</p></li>
<li><p>Realiza una gráfica de líneas para <span class="math inline">\(Z_{(x,y)}\)</span> identificando la función de interpolación lineal <span class="math inline">\(f(x)\)</span> asociada.</p></li>
<li><p>Realiza una gráfica de barras de <span class="math inline">\(\vec{w}\)</span> especificando quiénes son los <span class="math inline">\(a_i\)</span> y los <span class="math inline">\(n_j\)</span>.</p></li>
<li><p>Estima mediante <span class="math inline">\(\hat{p}\)</span> la función de probabilidad de <span class="math inline">\(\vec{w}\)</span>.</p></li>
<li><p>Identifica la función de distribución empírica para <span class="math inline">\(\vec{x}\)</span>, <span class="math inline">\(\hat{F}\)</span> y grafícala.</p></li>
<li><p>Realiza un histograma con <span class="math inline">\(h = 2\)</span> para <span class="math inline">\(x\)</span>. Toma <span class="math inline">\(\kappa = 4\)</span>.</p></li>
<li><p>Ajusta una densidad kernel a <span class="math inline">\(\vec{x}\)</span> con <span class="math inline">\(h = 1\)</span> y usando un kernel <span class="math inline">\(K\)</span> triangular. Calcula <span class="math inline">\(\hat{f}(x)\)</span> para <span class="math inline">\(x = 0,1,2,3,4\)</span>.</p></li>
</ol>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ejercicios-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": ["night", "white", "sepia"],
"family": "sans",
"size": [2, 4]
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Introduccion_a_Muestreo.pdf", "Introduccion_a_Muestreo.epub"],
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"search": true,
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
