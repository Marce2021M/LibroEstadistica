<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 6 Intervalos de Confianza mediante bootstrap | Estadística I: Análisis exploratorio de datos y muestreo</title>
  <meta name="description" content="Libro de estadística aplicada: temas de análisis exploratorio y muestreo" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 6 Intervalos de Confianza mediante bootstrap | Estadística I: Análisis exploratorio de datos y muestreo" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Libro de estadística aplicada: temas de análisis exploratorio y muestreo" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 6 Intervalos de Confianza mediante bootstrap | Estadística I: Análisis exploratorio de datos y muestreo" />
  
  <meta name="twitter:description" content="Libro de estadística aplicada: temas de análisis exploratorio y muestreo" />
  

<meta name="author" content="Rodrigo Zepeda-Tello" />


<meta name="date" content="2021-08-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="muestreo-aleatorio-estratificado.html"/>
<link rel="next" href="muestreo-aleatorio-multietápico.html"/>
<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Estadística I: Análisis exploratorio de datos y muestreo</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Historia del muestro</a></li>
<li class="chapter" data-level="2" data-path="conceptos.html"><a href="conceptos.html"><i class="fa fa-check"></i><b>2</b> Conceptos</a></li>
<li class="chapter" data-level="3" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html"><i class="fa fa-check"></i><b>3</b> Análisis Exploratorio de Datos</a>
<ul>
<li class="chapter" data-level="3.1" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#inicio"><i class="fa fa-check"></i><b>3.1</b> Inicio</a></li>
<li class="chapter" data-level="3.2" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#librerías"><i class="fa fa-check"></i><b>3.2</b> Librerías</a></li>
<li class="chapter" data-level="3.3" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#base-a-analizar"><i class="fa fa-check"></i><b>3.3</b> Base a analizar</a></li>
<li class="chapter" data-level="3.4" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#definiciones-y-notación"><i class="fa fa-check"></i><b>3.4</b> Definiciones y notación</a></li>
<li class="chapter" data-level="3.5" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#estadísticos-univariados"><i class="fa fa-check"></i><b>3.5</b> Estadísticos univariados</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#definición-estadístico"><i class="fa fa-check"></i><b>3.5.1</b> Definición [Estadístico]</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#ejercicio"><i class="fa fa-check"></i><b>3.6</b> Ejercicio</a></li>
<li class="chapter" data-level="3.7" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#ejercicios"><i class="fa fa-check"></i><b>3.7</b> Ejercicios</a></li>
<li class="chapter" data-level="3.8" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#gráficas-univariadas"><i class="fa fa-check"></i><b>3.8</b> Gráficas univariadas</a></li>
<li class="chapter" data-level="3.9" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#gráficas-bivariadas"><i class="fa fa-check"></i><b>3.9</b> Gráficas bivariadas</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#ejercicio-1"><i class="fa fa-check"></i><b>3.9.1</b> Ejercicio</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#estadísticos-bivariados"><i class="fa fa-check"></i><b>3.10</b> Estadísticos bivariados</a>
<ul>
<li class="chapter" data-level="3.10.1" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#ejercicio-2"><i class="fa fa-check"></i><b>3.10.1</b> Ejercicio</a></li>
</ul></li>
<li class="chapter" data-level="3.11" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#ejercicio-3"><i class="fa fa-check"></i><b>3.11</b> Ejercicio</a></li>
<li class="chapter" data-level="3.12" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#ajuste-funcional"><i class="fa fa-check"></i><b>3.12</b> Ajuste funcional</a>
<ul>
<li class="chapter" data-level="3.12.1" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#ejercicio-4"><i class="fa fa-check"></i><b>3.12.1</b> Ejercicio</a></li>
<li class="chapter" data-level="3.12.2" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#ejercicio-sugerido"><i class="fa fa-check"></i><b>3.12.2</b> Ejercicio sugerido</a></li>
</ul></li>
<li class="chapter" data-level="3.13" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#ejercicios-del-capítulo"><i class="fa fa-check"></i><b>3.13</b> Ejercicios del capítulo</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="muestreo-aleatorio-simple.html"><a href="muestreo-aleatorio-simple.html"><i class="fa fa-check"></i><b>4</b> Muestreo Aleatorio Simple</a>
<ul>
<li class="chapter" data-level="4.1" data-path="muestreo-aleatorio-simple.html"><a href="muestreo-aleatorio-simple.html#inicio-1"><i class="fa fa-check"></i><b>4.1</b> Inicio</a></li>
<li class="chapter" data-level="4.2" data-path="muestreo-aleatorio-simple.html"><a href="muestreo-aleatorio-simple.html#librerías-1"><i class="fa fa-check"></i><b>4.2</b> Librerías</a></li>
<li class="chapter" data-level="4.3" data-path="muestreo-aleatorio-simple.html"><a href="muestreo-aleatorio-simple.html#notación"><i class="fa fa-check"></i><b>4.3</b> Notación</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="muestreo-aleatorio-simple.html"><a href="muestreo-aleatorio-simple.html#ejemplo"><i class="fa fa-check"></i><b>4.3.1</b> Ejemplo</a></li>
<li class="chapter" data-level="4.3.2" data-path="muestreo-aleatorio-simple.html"><a href="muestreo-aleatorio-simple.html#ejercicio-5"><i class="fa fa-check"></i><b>4.3.2</b> Ejercicio</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="muestreo-aleatorio-simple.html"><a href="muestreo-aleatorio-simple.html#muestreo-aleatorio-simple-sin-reemplazo-massr"><i class="fa fa-check"></i><b>4.4</b> Muestreo Aleatorio Simple sin Reemplazo (MAS/sR)</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="muestreo-aleatorio-simple.html"><a href="muestreo-aleatorio-simple.html#ejercicio-6"><i class="fa fa-check"></i><b>4.4.1</b> Ejercicio</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="muestreo-aleatorio-simple.html"><a href="muestreo-aleatorio-simple.html#teorema-del-límite-central-aplicación"><i class="fa fa-check"></i><b>4.5</b> Teorema del Límite Central (Aplicación)</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="muestreo-aleatorio-simple.html"><a href="muestreo-aleatorio-simple.html#estimación-de-intervalos-de-confianza-para-el-total"><i class="fa fa-check"></i><b>4.5.1</b> Estimación de intervalos de confianza para el total</a></li>
<li class="chapter" data-level="4.5.2" data-path="muestreo-aleatorio-simple.html"><a href="muestreo-aleatorio-simple.html#ejemplo-con-simulación"><i class="fa fa-check"></i><b>4.5.2</b> Ejemplo con simulación:</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="muestreo-aleatorio-simple.html"><a href="muestreo-aleatorio-simple.html#ejemplo-resumen-estimación-de-una-proporción-bajo-muestreo-aleatorio-simple-sin-reemplazo"><i class="fa fa-check"></i><b>4.6</b> Ejemplo Resumen: Estimación de una proporción bajo muestreo aleatorio simple sin reemplazo</a></li>
<li class="chapter" data-level="4.7" data-path="muestreo-aleatorio-simple.html"><a href="muestreo-aleatorio-simple.html#ejemplo-resumen-estimación-del-total-de-individuos-en-una-fotografía"><i class="fa fa-check"></i><b>4.7</b> Ejemplo Resumen: Estimación del total de individuos en una fotografía</a></li>
<li class="chapter" data-level="4.8" data-path="muestreo-aleatorio-simple.html"><a href="muestreo-aleatorio-simple.html#ejercicio-7"><i class="fa fa-check"></i><b>4.8</b> Ejercicio:</a></li>
<li class="chapter" data-level="4.9" data-path="muestreo-aleatorio-simple.html"><a href="muestreo-aleatorio-simple.html#ejemplo-resumen-estimación-de-una-región-crítica"><i class="fa fa-check"></i><b>4.9</b> Ejemplo Resumen: Estimación de una región crítica</a></li>
<li class="chapter" data-level="4.10" data-path="muestreo-aleatorio-simple.html"><a href="muestreo-aleatorio-simple.html#ejemplo-resumen-estimación-del-total-de-una-población"><i class="fa fa-check"></i><b>4.10</b> Ejemplo Resumen: Estimación del total de una población</a></li>
<li class="chapter" data-level="4.11" data-path="muestreo-aleatorio-simple.html"><a href="muestreo-aleatorio-simple.html#demostración-del-teorema-del-límite-central-para-muestras-finitas"><i class="fa fa-check"></i><b>4.11</b> Demostración del Teorema del Límite Central para Muestras Finitas</a></li>
<li class="chapter" data-level="4.12" data-path="muestreo-aleatorio-simple.html"><a href="muestreo-aleatorio-simple.html#muestreo-aleatorio-simple-bernoulli-be"><i class="fa fa-check"></i><b>4.12</b> Muestreo Aleatorio Simple Bernoulli (BE)</a>
<ul>
<li class="chapter" data-level="4.12.1" data-path="muestreo-aleatorio-simple.html"><a href="muestreo-aleatorio-simple.html#ejercicio-8"><i class="fa fa-check"></i><b>4.12.1</b> Ejercicio</a></li>
<li class="chapter" data-level="4.12.2" data-path="muestreo-aleatorio-simple.html"><a href="muestreo-aleatorio-simple.html#ejemplo-1"><i class="fa fa-check"></i><b>4.12.2</b> Ejemplo</a></li>
<li class="chapter" data-level="4.12.3" data-path="muestreo-aleatorio-simple.html"><a href="muestreo-aleatorio-simple.html#un-mejor-estimador-el-proporcional-al-tamaño"><i class="fa fa-check"></i><b>4.12.3</b> Un mejor estimador: el proporcional al tamaño</a></li>
</ul></li>
<li class="chapter" data-level="4.13" data-path="muestreo-aleatorio-simple.html"><a href="muestreo-aleatorio-simple.html#ejemplo-resumen-aduana"><i class="fa fa-check"></i><b>4.13</b> Ejemplo Resumen: Aduana</a></li>
<li class="chapter" data-level="4.14" data-path="muestreo-aleatorio-simple.html"><a href="muestreo-aleatorio-simple.html#muestreo-aleatorio-simple-con-reemplazo-mascr"><i class="fa fa-check"></i><b>4.14</b> Muestreo Aleatorio Simple con Reemplazo (MAS/cR)</a></li>
<li class="chapter" data-level="4.15" data-path="muestreo-aleatorio-simple.html"><a href="muestreo-aleatorio-simple.html#ejemplo-resumen-proporción-de-trabajadores-enfermos-con-o-sin-reemplazo"><i class="fa fa-check"></i><b>4.15</b> Ejemplo Resumen: Proporción de trabajadores enfermos con o sin reemplazo</a></li>
<li class="chapter" data-level="4.16" data-path="muestreo-aleatorio-simple.html"><a href="muestreo-aleatorio-simple.html#ejemplo-resumen-captura-recaptura-con-reemplazo"><i class="fa fa-check"></i><b>4.16</b> Ejemplo Resumen: Captura-Recaptura con reemplazo</a></li>
<li class="chapter" data-level="4.17" data-path="muestreo-aleatorio-simple.html"><a href="muestreo-aleatorio-simple.html#muestreo-aleatorio-simple-ponderado-masp"><i class="fa fa-check"></i><b>4.17</b> Muestreo Aleatorio Simple Ponderado (MAS/P)</a></li>
<li class="chapter" data-level="4.18" data-path="muestreo-aleatorio-simple.html"><a href="muestreo-aleatorio-simple.html#ejercicios-1"><i class="fa fa-check"></i><b>4.18</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="muestreo-aleatorio-estratificado.html"><a href="muestreo-aleatorio-estratificado.html"><i class="fa fa-check"></i><b>5</b> Muestreo Aleatorio Estratificado</a>
<ul>
<li class="chapter" data-level="5.1" data-path="muestreo-aleatorio-estratificado.html"><a href="muestreo-aleatorio-estratificado.html#introducción-a-muestreo-aleatorio-estratificado-mae"><i class="fa fa-check"></i><b>5.1</b> Introducción a Muestreo Aleatorio Estratificado (MAE)</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="muestreo-aleatorio-estratificado.html"><a href="muestreo-aleatorio-estratificado.html#ejemplo-2"><i class="fa fa-check"></i><b>5.1.1</b> Ejemplo</a></li>
<li class="chapter" data-level="5.1.2" data-path="muestreo-aleatorio-estratificado.html"><a href="muestreo-aleatorio-estratificado.html#ejercicio-sugerido-1"><i class="fa fa-check"></i><b>5.1.2</b> Ejercicio sugerido</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="muestreo-aleatorio-estratificado.html"><a href="muestreo-aleatorio-estratificado.html#alocación"><i class="fa fa-check"></i><b>5.2</b> Alocación</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="muestreo-aleatorio-estratificado.html"><a href="muestreo-aleatorio-estratificado.html#alocación-proporcional-al-tamaño"><i class="fa fa-check"></i><b>5.2.1</b> Alocación proporcional al tamaño</a></li>
<li class="chapter" data-level="5.2.2" data-path="muestreo-aleatorio-estratificado.html"><a href="muestreo-aleatorio-estratificado.html#alocación-óptima"><i class="fa fa-check"></i><b>5.2.2</b> Alocación óptima</a></li>
<li class="chapter" data-level="5.2.3" data-path="muestreo-aleatorio-estratificado.html"><a href="muestreo-aleatorio-estratificado.html#ejemplo-3"><i class="fa fa-check"></i><b>5.2.3</b> Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="muestreo-aleatorio-estratificado.html"><a href="muestreo-aleatorio-estratificado.html#ejercicio-de-clase"><i class="fa fa-check"></i><b>5.3</b> Ejercicio de clase:</a></li>
<li class="chapter" data-level="5.4" data-path="muestreo-aleatorio-estratificado.html"><a href="muestreo-aleatorio-estratificado.html#ejercicio-en-r-tipo-control"><i class="fa fa-check"></i><b>5.4</b> Ejercicio en R tipo control</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="intervalos-de-confianza-mediante-bootstrap.html"><a href="intervalos-de-confianza-mediante-bootstrap.html"><i class="fa fa-check"></i><b>6</b> Intervalos de Confianza mediante bootstrap</a>
<ul>
<li class="chapter" data-level="6.1" data-path="intervalos-de-confianza-mediante-bootstrap.html"><a href="intervalos-de-confianza-mediante-bootstrap.html#inicio-2"><i class="fa fa-check"></i><b>6.1</b> Inicio</a></li>
<li class="chapter" data-level="6.2" data-path="intervalos-de-confianza-mediante-bootstrap.html"><a href="intervalos-de-confianza-mediante-bootstrap.html#intervalos-asintóticos"><i class="fa fa-check"></i><b>6.2</b> Intervalos asintóticos</a></li>
<li class="chapter" data-level="6.3" data-path="intervalos-de-confianza-mediante-bootstrap.html"><a href="intervalos-de-confianza-mediante-bootstrap.html#muestreo-basado-en-modelos"><i class="fa fa-check"></i><b>6.3</b> Muestreo basado en modelos</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="intervalos-de-confianza-mediante-bootstrap.html"><a href="intervalos-de-confianza-mediante-bootstrap.html#ejemplo-poisson"><i class="fa fa-check"></i><b>6.3.1</b> Ejemplo Poisson</a></li>
<li class="chapter" data-level="6.3.2" data-path="intervalos-de-confianza-mediante-bootstrap.html"><a href="intervalos-de-confianza-mediante-bootstrap.html#ejercicio-9"><i class="fa fa-check"></i><b>6.3.2</b> Ejercicio</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="intervalos-de-confianza-mediante-bootstrap.html"><a href="intervalos-de-confianza-mediante-bootstrap.html#intervalos-bootstrap"><i class="fa fa-check"></i><b>6.4</b> Intervalos Bootstrap</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="intervalos-de-confianza-mediante-bootstrap.html"><a href="intervalos-de-confianza-mediante-bootstrap.html#boostrap-bajo-un-modelo"><i class="fa fa-check"></i><b>6.4.1</b> Boostrap bajo un modelo</a></li>
<li class="chapter" data-level="6.4.2" data-path="intervalos-de-confianza-mediante-bootstrap.html"><a href="intervalos-de-confianza-mediante-bootstrap.html#boostrap-de-una-muestra"><i class="fa fa-check"></i><b>6.4.2</b> Boostrap de una muestra</a></li>
<li class="chapter" data-level="6.4.3" data-path="intervalos-de-confianza-mediante-bootstrap.html"><a href="intervalos-de-confianza-mediante-bootstrap.html#ejemplo-4"><i class="fa fa-check"></i><b>6.4.3</b> Ejemplo</a></li>
<li class="chapter" data-level="6.4.4" data-path="intervalos-de-confianza-mediante-bootstrap.html"><a href="intervalos-de-confianza-mediante-bootstrap.html#ejercicio-10"><i class="fa fa-check"></i><b>6.4.4</b> Ejercicio</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="muestreo-aleatorio-multietápico.html"><a href="muestreo-aleatorio-multietápico.html"><i class="fa fa-check"></i><b>7</b> Muestreo Aleatorio Multietápico</a>
<ul>
<li class="chapter" data-level="7.1" data-path="muestreo-aleatorio-multietápico.html"><a href="muestreo-aleatorio-multietápico.html#muestreo-aleatorio-por-clusters-en-una-sola-etapa"><i class="fa fa-check"></i><b>7.1</b> Muestreo aleatorio por clusters en una sola etapa</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="muestreo-aleatorio-multietápico.html"><a href="muestreo-aleatorio-multietápico.html#ejemplo-5"><i class="fa fa-check"></i><b>7.1.1</b> Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="muestreo-aleatorio-multietápico.html"><a href="muestreo-aleatorio-multietápico.html#muestreo-aleatorio-por-clusters-bietápico-en-dos-etapas"><i class="fa fa-check"></i><b>7.2</b> Muestreo aleatorio por clusters bietápico (en dos etapas)</a></li>
<li class="chapter" data-level="7.3" data-path="muestreo-aleatorio-multietápico.html"><a href="muestreo-aleatorio-multietápico.html#ejemplo-disco-duro"><i class="fa fa-check"></i><b>7.3</b> Ejemplo: Disco duro</a></li>
<li class="chapter" data-level="7.4" data-path="muestreo-aleatorio-multietápico.html"><a href="muestreo-aleatorio-multietápico.html#ejemplo-encuesta-nacional-de-salud"><i class="fa fa-check"></i><b>7.4</b> Ejemplo: Encuesta Nacional de Salud</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a></li>
<li class="appendix"><span><b>Apéndice</b></span></li>
<li class="chapter" data-level="A" data-path="programación-en-r.html"><a href="programación-en-r.html"><i class="fa fa-check"></i><b>A</b> Programación en <code>R</code></a>
<ul>
<li class="chapter" data-level="A.1" data-path="programación-en-r.html"><a href="programación-en-r.html#algunas-ventajas-de-r-y-cosas-no-tan-padres"><i class="fa fa-check"></i><b>A.1</b> Algunas ventajas de <code>R</code> y cosas no tan padres</a>
<ul>
<li class="chapter" data-level="A.1.1" data-path="programación-en-r.html"><a href="programación-en-r.html#puntos-a-favor-de-r"><i class="fa fa-check"></i><b>A.1.1</b> Puntos a favor de <code>R</code></a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="programación-en-r.html"><a href="programación-en-r.html#bienvenidx-a-r-camp-pontanezen-sí-así-se-llama-esta-versión"><i class="fa fa-check"></i><b>A.2</b> Bienvenidx a <code>R</code>, Camp Pontanezen (sí, así se llama esta versión)</a></li>
<li class="chapter" data-level="A.3" data-path="programación-en-r.html"><a href="programación-en-r.html#instalando-cosas"><i class="fa fa-check"></i><b>A.3</b> Instalando cosas</a>
<ul>
<li class="chapter" data-level="A.3.1" data-path="programación-en-r.html"><a href="programación-en-r.html#instalación-de-r"><i class="fa fa-check"></i><b>A.3.1</b> Instalación de <code>R</code></a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="programación-en-r.html"><a href="programación-en-r.html#instalación-de-rstudio"><i class="fa fa-check"></i><b>A.4</b> Instalación de <code>RStudio</code></a></li>
<li class="chapter" data-level="A.5" data-path="programación-en-r.html"><a href="programación-en-r.html#primeros-pasos-en-r-usando-rstudio"><i class="fa fa-check"></i><b>A.5</b> Primeros pasos en <code>R</code> usando <code>RStudio</code></a></li>
<li class="chapter" data-level="A.6" data-path="programación-en-r.html"><a href="programación-en-r.html#cálculos-numéricos"><i class="fa fa-check"></i><b>A.6</b> Cálculos numéricos</a>
<ul>
<li class="chapter" data-level="A.6.1" data-path="programación-en-r.html"><a href="programación-en-r.html#ejercicio-11"><i class="fa fa-check"></i><b>A.6.1</b> Ejercicio</a></li>
<li class="chapter" data-level="A.6.2" data-path="programación-en-r.html"><a href="programación-en-r.html#ejercicio-12"><i class="fa fa-check"></i><b>A.6.2</b> Ejercicio</a></li>
<li class="chapter" data-level="A.6.3" data-path="programación-en-r.html"><a href="programación-en-r.html#respuestas"><i class="fa fa-check"></i><b>A.6.3</b> Respuestas</a></li>
</ul></li>
<li class="chapter" data-level="A.7" data-path="programación-en-r.html"><a href="programación-en-r.html#variables"><i class="fa fa-check"></i><b>A.7</b> Variables</a>
<ul>
<li class="chapter" data-level="A.7.1" data-path="programación-en-r.html"><a href="programación-en-r.html#ejercicios-2"><i class="fa fa-check"></i><b>A.7.1</b> Ejercicios</a></li>
<li class="chapter" data-level="A.7.2" data-path="programación-en-r.html"><a href="programación-en-r.html#nivel-3"><i class="fa fa-check"></i><b>A.7.2</b> NIVEL 3</a></li>
</ul></li>
<li class="chapter" data-level="A.8" data-path="programación-en-r.html"><a href="programación-en-r.html#observaciones-sobre-la-aritmética-de-punto-flotante"><i class="fa fa-check"></i><b>A.8</b> Observaciones sobre la aritmética de punto flotante</a>
<ul>
<li class="chapter" data-level="A.8.1" data-path="programación-en-r.html"><a href="programación-en-r.html#cómo-checar-un-if"><i class="fa fa-check"></i><b>A.8.1</b> ¿Cómo checar un if?</a></li>
</ul></li>
<li class="chapter" data-level="A.9" data-path="programación-en-r.html"><a href="programación-en-r.html#leer-y-almacenar-variables-en-r"><i class="fa fa-check"></i><b>A.9</b> Leer y almacenar variables en <code>R</code></a>
<ul>
<li class="chapter" data-level="A.9.1" data-path="programación-en-r.html"><a href="programación-en-r.html#ejercicio-13"><i class="fa fa-check"></i><b>A.9.1</b> Ejercicio</a></li>
</ul></li>
<li class="chapter" data-level="A.10" data-path="programación-en-r.html"><a href="programación-en-r.html#instalación-de-paquetes"><i class="fa fa-check"></i><b>A.10</b> Instalación de paquetes</a>
<ul>
<li class="chapter" data-level="A.10.1" data-path="programación-en-r.html"><a href="programación-en-r.html#ejercicios-3"><i class="fa fa-check"></i><b>A.10.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="A.11" data-path="programación-en-r.html"><a href="programación-en-r.html#comentarios-adicionales-sobre-el-formato"><i class="fa fa-check"></i><b>A.11</b> Comentarios adicionales sobre el formato</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="repaso-de-proba.html"><a href="repaso-de-proba.html"><i class="fa fa-check"></i><b>B</b> Repaso de Proba</a>
<ul>
<li class="chapter" data-level="B.1" data-path="repaso-de-proba.html"><a href="repaso-de-proba.html#funciones-indicadoras"><i class="fa fa-check"></i><b>B.1</b> Funciones indicadoras</a></li>
<li class="chapter" data-level="B.2" data-path="repaso-de-proba.html"><a href="repaso-de-proba.html#conteo"><i class="fa fa-check"></i><b>B.2</b> Conteo</a></li>
<li class="chapter" data-level="B.3" data-path="repaso-de-proba.html"><a href="repaso-de-proba.html#espacios-de-probabilidad"><i class="fa fa-check"></i><b>B.3</b> Espacios de probabilidad</a></li>
<li class="chapter" data-level="B.4" data-path="repaso-de-proba.html"><a href="repaso-de-proba.html#probabilidad-condicional"><i class="fa fa-check"></i><b>B.4</b> Probabilidad condicional</a></li>
<li class="chapter" data-level="B.5" data-path="repaso-de-proba.html"><a href="repaso-de-proba.html#independencia"><i class="fa fa-check"></i><b>B.5</b> Independencia</a></li>
<li class="chapter" data-level="B.6" data-path="repaso-de-proba.html"><a href="repaso-de-proba.html#variables-aleatorias-y-función-de-distribución-acumulada"><i class="fa fa-check"></i><b>B.6</b> Variables aleatorias y función de distribución (acumulada)</a></li>
<li class="chapter" data-level="B.7" data-path="repaso-de-proba.html"><a href="repaso-de-proba.html#funciones-de-masa-de-probabilidad"><i class="fa fa-check"></i><b>B.7</b> Funciones de masa de probabilidad</a></li>
<li class="chapter" data-level="B.8" data-path="repaso-de-proba.html"><a href="repaso-de-proba.html#funciones-de-densidad"><i class="fa fa-check"></i><b>B.8</b> Funciones de densidad</a></li>
<li class="chapter" data-level="B.9" data-path="repaso-de-proba.html"><a href="repaso-de-proba.html#teorema-de-cambio-de-variable-unidimensional"><i class="fa fa-check"></i><b>B.9</b> Teorema de cambio de variable unidimensional</a></li>
<li class="chapter" data-level="B.10" data-path="repaso-de-proba.html"><a href="repaso-de-proba.html#probabilidad-multivariada"><i class="fa fa-check"></i><b>B.10</b> Probabilidad Multivariada</a></li>
<li class="chapter" data-level="B.11" data-path="repaso-de-proba.html"><a href="repaso-de-proba.html#esperanza-varianza-y-covarianza"><i class="fa fa-check"></i><b>B.11</b> Esperanza, varianza y covarianza</a>
<ul>
<li class="chapter" data-level="B.11.1" data-path="repaso-de-proba.html"><a href="repaso-de-proba.html#propiedades-de-valor-esperado-varianza-y-covarianza"><i class="fa fa-check"></i><b>B.11.1</b> Propiedades de valor esperado, varianza y covarianza</a></li>
</ul></li>
<li class="chapter" data-level="B.12" data-path="repaso-de-proba.html"><a href="repaso-de-proba.html#condicionamiento-por-otra-variable-aleatoria"><i class="fa fa-check"></i><b>B.12</b> Condicionamiento por otra variable aleatoria</a></li>
<li class="chapter" data-level="B.13" data-path="repaso-de-proba.html"><a href="repaso-de-proba.html#funciones-características"><i class="fa fa-check"></i><b>B.13</b> Funciones características</a></li>
<li class="chapter" data-level="B.14" data-path="repaso-de-proba.html"><a href="repaso-de-proba.html#convergencias"><i class="fa fa-check"></i><b>B.14</b> Convergencias</a>
<ul>
<li class="chapter" data-level="B.14.1" data-path="repaso-de-proba.html"><a href="repaso-de-proba.html#teorema-de-continuidad-de-lévy"><i class="fa fa-check"></i><b>B.14.1</b> Teorema de continuidad de Lévy</a></li>
</ul></li>
<li class="chapter" data-level="B.15" data-path="repaso-de-proba.html"><a href="repaso-de-proba.html#ley-de-los-grandes-números"><i class="fa fa-check"></i><b>B.15</b> Ley de los grandes números</a></li>
<li class="chapter" data-level="B.16" data-path="repaso-de-proba.html"><a href="repaso-de-proba.html#teorema-del-límite-central"><i class="fa fa-check"></i><b>B.16</b> Teorema del límite central</a>
<ul>
<li class="chapter" data-level="B.16.1" data-path="repaso-de-proba.html"><a href="repaso-de-proba.html#programación-en-r-del-teorema-del-límite-central-con-variables-aleatorias-independientes-idénticamente-distribuidas"><i class="fa fa-check"></i><b>B.16.1</b> Programación en <code>R</code> del teorema del límite central con variables aleatorias independientes idénticamente distribuidas</a></li>
<li class="chapter" data-level="B.16.2" data-path="repaso-de-proba.html"><a href="repaso-de-proba.html#ejercicio-14"><i class="fa fa-check"></i><b>B.16.2</b> Ejercicio</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/RodrigoZepeda/LibroEstadistica" target="blank">Rodrigo Zepeda Tello | Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International Public License</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Estadística I: Análisis exploratorio de datos y muestreo</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="intervalos-de-confianza-mediante-bootstrap" class="section level1" number="6">
<h1><span class="header-section-number">Capítulo 6</span> Intervalos de Confianza mediante bootstrap</h1>
<div id="inicio-2" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Inicio</h2>
<p>En esta sección analizaremos más a fondo una técnica (llamada <em>bootstrap</em>) para realizar intervalos de confianza. Comenzaremos haciéndolo para el caso de experimentos y luego veremos cómo es distinto para el caso de muestreo aleatorio en poblaciones finitas y realizaremos ese caso.</p>
</div>
<div id="intervalos-asintóticos" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Intervalos asintóticos</h2>
<p>Los intervalos de confianza que hemos construido hasta ahora son con la idea de normalidad asintótica; se basan en la idea de que:</p>
<p><span class="math display">\[
Z =\lim_{N-n, n \to \infty} \sqrt{\frac{1}{\textrm{Var}(\bar{x}_{\mathcal{S}})}} \cdot  \Big( \frac{1}{n}\sum_{i = 1}^N x_i \mathbb{I}_{\mathcal{S}}(x_i) - \bar{x}_{\mathcal{U}}\Big) \sim \text{Normal}(0,1)
\]</span></p>
<p>Es decir, si tuviéramos una población infinita <span class="math inline">\(N\)</span> y una muestra infinita <span class="math inline">\(n\)</span> entonces la diferencia entre la media muestral y la media verdadera (normalizadas por la varianza) tienen una distribución normal. Empero, esto no siempre funciona como el siguiente con <span class="math inline">\(n = 15\)</span> muestras nos enseña:</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Tomar muestras de tamaño pequeño</span></span>
<span id="cb213-2"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb213-2" aria-hidden="true" tabindex="-1"></a>n       <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb213-3"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb213-3" aria-hidden="true" tabindex="-1"></a>lambda  <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb213-4"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb213-4" aria-hidden="true" tabindex="-1"></a>Z       <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>)</span>
<span id="cb213-5"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb213-5" aria-hidden="true" tabindex="-1"></a>nsim    <span class="ot">&lt;-</span> <span class="dv">100</span>    <span class="co">#Cantidad sims</span></span>
<span id="cb213-6"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb213-6" aria-hidden="true" tabindex="-1"></a>N       <span class="ot">&lt;-</span> <span class="dv">1000000</span> <span class="co">#Tamaño poblaciím</span></span>
<span id="cb213-7"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb213-7" aria-hidden="true" tabindex="-1"></a>pop     <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), N, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="dv">1</span> <span class="sc">-</span> lambda, lambda))</span>
<span id="cb213-8"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb213-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-9"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb213-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-10"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb213-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Creamos las bases donde guardar los datos</span></span>
<span id="cb213-11"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb213-11" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">nrow =</span> nsim))</span>
<span id="cb213-12"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb213-12" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(datos) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;IC_Bajo&quot;</span>,<span class="st">&quot;Media&quot;</span>,<span class="st">&quot;IC_Alto&quot;</span>)</span>
<span id="cb213-13"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb213-13" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>Sim       <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>nsim</span>
<span id="cb213-14"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb213-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-15"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb213-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Obtenemos 100 muestras</span></span>
<span id="cb213-16"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb213-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nsim){</span>
<span id="cb213-17"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb213-17" aria-hidden="true" tabindex="-1"></a>  muestra        <span class="ot">&lt;-</span> <span class="fu">sample</span>(pop, n)</span>
<span id="cb213-18"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb213-18" aria-hidden="true" tabindex="-1"></a>  datos<span class="sc">$</span>Media[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(muestra)</span>
<span id="cb213-19"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb213-19" aria-hidden="true" tabindex="-1"></a>  varianza       <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> n<span class="sc">/</span>N)<span class="sc">/</span>n<span class="sc">*</span><span class="fu">var</span>(muestra)</span>
<span id="cb213-20"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb213-20" aria-hidden="true" tabindex="-1"></a>  datos<span class="sc">$</span>IC_Bajo[i]  <span class="ot">&lt;-</span> datos<span class="sc">$</span>Media[i] <span class="sc">-</span> Z<span class="sc">*</span><span class="fu">sqrt</span>(varianza)</span>
<span id="cb213-21"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb213-21" aria-hidden="true" tabindex="-1"></a>  datos<span class="sc">$</span>IC_Alto[i]  <span class="ot">&lt;-</span> datos<span class="sc">$</span>Media[i] <span class="sc">+</span> Z<span class="sc">*</span><span class="fu">sqrt</span>(varianza)</span>
<span id="cb213-22"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb213-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb213-23"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb213-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-24"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb213-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos, <span class="fu">aes</span>(<span class="at">x =</span> Sim)) <span class="sc">+</span></span>
<span id="cb213-25"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb213-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> IC_Bajo, <span class="at">ymax =</span> IC_Alto)) <span class="sc">+</span></span>
<span id="cb213-26"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb213-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Media), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb213-27"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb213-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> <span class="fu">mean</span>(pop) )) <span class="sc">+</span></span>
<span id="cb213-28"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb213-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb213-29"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb213-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb213-30"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb213-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Simulación&quot;</span>,</span>
<span id="cb213-31"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb213-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Proporción p&quot;</span>,</span>
<span id="cb213-32"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb213-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Estimación de p para una Bernoulli&quot;</span></span>
<span id="cb213-33"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb213-33" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="NotasEstadistica_files/figure-html/unnamed-chunk-195-1.png" width="672" />
En el caso de la Bernoulli, por ejemplo, se puede un mejor intervalo de confianza para cuando la proporción <span class="math inline">\(\hat{p} = 0\)</span> <strong>bajo una hipótesis distribucional</strong>. Esta se encuentra en el paquete <code>binom</code> de <code>R</code>:</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(binom)</span>
<span id="cb214-2"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb214-2" aria-hidden="true" tabindex="-1"></a><span class="fu">binom.confint</span>(<span class="dv">0</span>, n, <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">method =</span> <span class="st">&#39;exact&#39;</span>)</span></code></pre></div>
<pre><code>##   method x  n mean lower     upper
## 1  exact 0 15    0     0 0.2180194</code></pre>
<p>La deducción de dichos intervalos se hace a través de un esquema distinto de muestreo: <strong>muestreo basado en modelos</strong>.</p>
</div>
<div id="muestreo-basado-en-modelos" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> Muestreo basado en modelos</h2>
<p>Quizá en otras clases de estadística viste muestreo de otra manera. Lo usual en Estadística Matemática es suponer se tienen un conjunto de <span class="math inline">\(n\)</span> variables aleatorias independientes idénticamente distribuidas que representan la cantidad de interés <span class="math inline">\(\{ Y_1, Y_2, \dots, Y_n\}\)</span>. De dichas variables se observa que toman los valores <span class="math inline">\(\{y_1, y_2, \dots, y_n\}\)</span> que son los medidos en la muestra. Aquí no se considera que haya un conjunto finito (universal) dado por la <strong>población</strong> sino que todas las variables provienen de una <strong>metapoblación</strong> (universo infinito de posibilidades). Así, por ejemplo, las alturas de individuos podrían tener una distribución gamma truncada y las alturas de personas en particular corresponden a realizaciones <em>independientes</em> de dichas <span class="math inline">\(Y_i\)</span>. Este enfoque lo que hace es convertir el problema de estimación en un problema de predicción. No es que <em>la altura</em> de un individuo sea aleatoria en el sentido de que siempre cambie sino que <em>por nuestra ignorancia</em> nosotros modelamos dicha altura con una variable aleatoria que representa, en esta <strong>metapoblación</strong> la altura de una cantidad infinita de individuos posibles. Bajo este esquema, una muestra aleatoria está dada por:
<span class="math display">\[
\mathcal{Y}_{(n)} = \{ Y_1, Y_2, \dots, Y_n\}
\]</span>
y la muestra observada es:</p>
<p><span class="math display">\[
\mathcal{y}_{(n)} = \{ y_1, y_2, \dots, y_m\}
\]</span>
Donde suponemos que lo que se observó fue que <span class="math inline">\(Y_i = y_i\)</span>. Un punto relevante aquí es que como las <span class="math inline">\(\{Y_i\}\)</span> son variables aleatorias éstas siguen algún modelo. En particular, se eligen modelos paramétricos para estos casos en los que la distribución asintótica no funciona. El problema de estimación se convierte ya sea en estimar el parámetro de la función de densidad (por ejemplo el <span class="math inline">\(\Theta = (\mu,\sigma)^T\)</span> de la normal o el <span class="math inline">\(\lambda\)</span> de una Poisson) o una función del mismo (como puede ser la mismísima función de densidad o distribución acumulada).</p>
<blockquote>
<p><strong>Nota</strong> El enfoque basado en modelos es muy bueno cuando se tienen pocos dados (o mal medidos) y las observaciones por sí mismas no son suficientes para poder generar información. En ese caso se hacen hipótesis adicionales (como un modelo) para los procesos de estimación.</p>
</blockquote>
<p>Veamos un ejemplo de generación de intervalos para la media (<span class="math inline">\(\lambda\)</span>) de una variable Poisson.</p>
<div id="ejemplo-poisson" class="section level3" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> Ejemplo Poisson</h3>
<p>Consideremos una muestra aleatoria <span class="math inline">\(\mathcal{Y}_{(n)} = \{ Y_1, Y_2, \dots, Y_n\}\)</span> de variables que se distribuyen <span class="math inline">\(\text{Poisson}(\lambda)\)</span>. Sabemos de proba (y si no lo sabemos no te apures, este ejemplo es sólo para ilustrar, no vamos a hacer más de esto) que la suma de variables aleatorias Poisson es Poisson, de donde:
<span class="math display">\[
\sum\limits_{i = 1}^n Y_i \sim\text{Poisson}(n \cdot \lambda)
\]</span>
por lo cual:
<span class="math display">\[
n \bar{Y} =  \sum\limits_{i = 1}^n Y_i \sim\text{Poisson}(n\lambda)
\]</span>
tenemos entonces que <span class="math inline">\(\mathbb{E}[\bar{Y}] = \lambda\)</span> (es insesgado). En este caso tomaremos que en particular observamos
<span class="math display">\[
\hat{y} = n \bar{y} = \sum\limits_{i = 1}^n y_i
\]</span></p>
<p>Observamos que para <span class="math inline">\(y\)</span> fijo, la distribución Poisson es decreciente antes de la media en <span class="math inline">\(\lambda\)</span> y creciente después de la media:
<img src="NotasEstadistica_files/figure-html/unnamed-chunk-197-1.png" width="672" /></p>
<p>Podemos entonces obtener un estimador <span class="math inline">\(\lambda\)</span> consideramos los valores <span class="math inline">\(\lambda_1\)</span> y <span class="math inline">\(\lambda_2\)</span> tales que:
<span class="math display">\[
\sum\limits_{k \leq \hat{y}} \dfrac{(n\lambda_1)^{\hat{y}} e^{-n\lambda_1}}{\hat{y}!} = \alpha / 2 \quad \text{ y } \quad \sum\limits_{k  \geq \hat{y}} \dfrac{(n\lambda_2)^{\hat{y}} e^{-n\lambda_2}}{\hat{y}!} =\alpha / 2
\]</span></p>
<p>El cual podemos encontrar facilmente con ayuda de <code>R</code>:</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Obtenemos la muestra</span></span>
<span id="cb216-2"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb216-2" aria-hidden="true" tabindex="-1"></a>n         <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb216-3"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb216-3" aria-hidden="true" tabindex="-1"></a>ybarra    <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">rpois</span>(n, <span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>))</span>
<span id="cb216-4"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb216-4" aria-hidden="true" tabindex="-1"></a>alpha.val <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb216-5"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb216-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-6"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb216-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Optimizamos</span></span>
<span id="cb216-7"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb216-7" aria-hidden="true" tabindex="-1"></a>func.opt<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda){<span class="fu">ppois</span>(ybarra, n<span class="sc">*</span>lambda) <span class="sc">-</span> alpha.val<span class="sc">/</span><span class="dv">2</span>}</span>
<span id="cb216-8"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb216-8" aria-hidden="true" tabindex="-1"></a>lambda<span class="fl">.1</span>   <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(func.opt<span class="fl">.1</span>, <span class="at">lower =</span> <span class="dv">0</span>, <span class="at">upper =</span> <span class="dv">10</span>, <span class="at">tol =</span> <span class="dv">1</span>.e<span class="dv">-10</span>)<span class="sc">$</span>root</span>
<span id="cb216-9"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb216-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-10"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb216-10" aria-hidden="true" tabindex="-1"></a>func.opt<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda){<span class="dv">1</span> <span class="sc">-</span> <span class="fu">ppois</span>(ybarra, n<span class="sc">*</span>lambda) <span class="sc">+</span> <span class="fu">dpois</span>(ybarra, n<span class="sc">*</span>lambda) <span class="sc">-</span> alpha.val<span class="sc">/</span><span class="dv">2</span>}</span>
<span id="cb216-11"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb216-11" aria-hidden="true" tabindex="-1"></a>lambda<span class="fl">.2</span>   <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(func.opt<span class="fl">.2</span>, <span class="at">lower =</span> <span class="dv">0</span>, <span class="at">upper =</span> <span class="dv">10</span>, <span class="at">tol =</span> <span class="dv">1</span>.e<span class="dv">-10</span>)<span class="sc">$</span>root</span>
<span id="cb216-12"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb216-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-13"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb216-13" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">&quot;Lower&quot;</span> <span class="ot">=</span> lambda<span class="fl">.2</span>, <span class="st">&quot;Upper&quot;</span> <span class="ot">=</span> lambda<span class="fl">.1</span>)</span></code></pre></div>
<pre><code>##      Lower      Upper 
## 0.03093361 0.43836365</code></pre>
<blockquote>
<p><strong>Nota</strong> Estos intervalos se conocen como <em>fiduciarios/fiduciales</em>. La idea es obtener los valores de <span class="math inline">\(\lambda\)</span> tales que <span class="math inline">\(\bar{Y} = Y\)</span> con un intervalo de probabilidad <span class="math inline">\((1 - \alpha)\times 100 \%\)</span>.</p>
</blockquote>
<p>En nuestro caso para análisis de encuestas <strong>no podemos usar directamente los resultados de estadística matemática que refieren más a experimentos</strong> pues en ello se supone independencia (lo cual casi nunca es cierto <em>para encuestas</em>). Sin embargo, tras el modelo que hemos estudiado ahora sí podríamos generar variables <em>tipo</em> las de estadística matemática con una hipótesis distribucional dadas por <span class="math inline">\(\{Z_i\}\)</span> donde
<span class="math display">\[
Z_k = \mathbb{I}(x_k)
\]</span>
pero sin que <span class="math inline">\(Z_i\)</span> sea independiente de <span class="math inline">\(Z_j\)</span>. En este caso las <span class="math inline">\(Z_i\)</span> siguen una distribución multivariada dictada por las <span class="math inline">\(\pi_k\)</span>.</p>
</div>
<div id="ejercicio-9" class="section level3" number="6.3.2">
<h3><span class="header-section-number">6.3.2</span> Ejercicio</h3>
<p>Obtén los intervalos fiduciarios para una variable aleatoria Bernoulli. Considera que la muestra está dada por:</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">646</span>)</span>
<span id="cb218-2"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb218-2" aria-hidden="true" tabindex="-1"></a>muestra <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dv">13</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.8</span>))</span></code></pre></div>
<blockquote>
<p><strong>Recuerda</strong> Si <span class="math inline">\(X_i \sim \textrm{Bernoulli}(p)\)</span> entonces <span class="math inline">\(\sum_{i = 1}^n X_i \sim \textrm{Binomial}(n,p)\)</span>.</p>
</blockquote>
</div>
</div>
<div id="intervalos-bootstrap" class="section level2" number="6.4">
<h2><span class="header-section-number">6.4</span> Intervalos Bootstrap</h2>
<p>Los intervalos anteriores requieren de manera implícita de la función de distribución acumulada original la cual puede ser muy complicada o desconocida. Los intervalos Bootstrap buscan aproximar dicha función mediante un remuestreo. La demostración exacta (con medida) de por qué funciona el Boostrap la puedes ver en <a href="https://www.cambridge.org/core/books/asymptotic-statistics/A3C7DAD3F7E66A1FA60E9C8FE132EE1D">Asymptotic Statistics</a>. La idea es <em>reconstruir</em> la función de distribución acumulada mediante remuestreo de la base (de una mejor manera aún que con la <span class="math inline">\(\hat{F}\)</span> empírica) y calcular estadísticos a partir de ella. Algunos estadísticos que se pueden calcular a partir de ella es, por ejemplo, la media muestral o la varianza así como los cuantiles. Para ello definiremos un concepto importante:</p>
<p><strong>Definición</strong>
Un estadístico <span class="math inline">\(t\)</span> es un funcional estadístico si <span class="math inline">\(t\)</span> es simétrica para <span class="math inline">\(y_1, y_2, \dots, y_N\)</span>. Dicho de otra forma, <span class="math inline">\(t\)</span> depende solamente de los valores ordenados <span class="math inline">\(y_{(1)}, y_{(2)}, \dots, y_{(N)}\)</span> y no del orden preciso (de la muestra o la población). En este caso <span class="math inline">\(t\)</span> depende sólo de la función de distribución y se escribe como <span class="math inline">\(t(F)\)</span> (en el caso poblacional) ó <span class="math inline">\(t(\hat{F})\)</span> en el caso muestral.</p>
<p>Un ejemplo de estadístico es la media pues (suponiendo <span class="math inline">\(F\)</span> discreta) por ejemplo:
<span class="math display">\[
\mu = \sum\limits_x x\big[\underbrace{F(x) - F(x^-)}_{\mathbb{P}(X = x)}\big]
\]</span>
Mientras que de manera muestral la estimación es idéntica mediante estimadores:
<span class="math display">\[
\hat{\mu} = \sum\limits_x x\big[\underbrace{\hat{F}(x) - \hat{F}(x^-)}_{\hat{\mathbb{P}}(X = x)}\big]
\]</span>
donde la notación <span class="math inline">\(F(x^-) = \lim_{y \to x^-} F(y)\)</span>.</p>
<p>Un ejemplo adicional es la mediana que corresponde a:
<span class="math display">\[
\textrm{Mediana} = F^{-1}(1/2)
\]</span>
donde
<span class="math display">\[
F^{-1}(p) = \inf \{ x \in \mathbb{R} : F(x) \geq p\}
\]</span>
es una pseudoinversa conocida como la función cuantil. (En el caso de <span class="math inline">\(F\)</span> continua es una inversa “bien” pero discreta no lo es porque esa cosa ni es invertible).</p>
<p>La idea de Bootstrap (con una demostración bastante técnica) es que para una <span class="math inline">\(\hat{F}_B\)</span> función de distribución empírica acumulada generada por Boostrap se tiene que:
<span class="math display">\[
\sqrt{n} \big( t(\hat{F}_{\text{B}}) - t(\hat{F})))
\]</span>
converge en distribución al mismo límite que:
<span class="math display">\[
\sqrt{n} \big( t(\hat{F}) - t(F)))
\]</span>
para cualquier <span class="math inline">\(t\)</span> función <a href="https://en.wikipedia.org/wiki/Hadamard_derivative">Hadamard-diferenciable.</a>.</p>
<p>Lo que en humano quiere decir es que muchísimos funcionales estadísticos convergen al verdadero. Lo interesante de Bootstrap (usualmente) no va a ser estimar el <span class="math inline">\(t\)</span> sino estimar un intervalo para <span class="math inline">\(t\)</span> a partir de remuestrear varias <span class="math inline">\(\hat{F}\)</span> mediante simulación.</p>
<blockquote>
<p><strong>Nota que no sé dónde poner</strong> Un tipo de Bootstrap específico es el Jacknife donde se elimina aleatoriamente un elemento de la base. <em>Model Assisted Survey Sampling</em> lo pone como otra cosa pero en realidad es un boostrap bajo otro método.</p>
</blockquote>
<div id="boostrap-bajo-un-modelo" class="section level3" number="6.4.1">
<h3><span class="header-section-number">6.4.1</span> Boostrap bajo un modelo</h3>
<p>Regresemos a nuestro ejemplo Poisson de la media pero esta vez usando Boostrap. Para ello consideramos la muestra de tamaño <span class="math inline">\(n = 20\)</span>.</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb219-1" aria-hidden="true" tabindex="-1"></a>n         <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb219-2"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb219-2" aria-hidden="true" tabindex="-1"></a>muestra   <span class="ot">&lt;-</span> <span class="fu">rpois</span>(n, <span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>)</span>
<span id="cb219-3"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb219-3" aria-hidden="true" tabindex="-1"></a>alpha.val <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb219-4"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb219-4" aria-hidden="true" tabindex="-1"></a>nsim      <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#Mil simulaciones nada más para no trabar</span></span>
<span id="cb219-5"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb219-5" aria-hidden="true" tabindex="-1"></a>media.completa <span class="ot">&lt;-</span> <span class="fu">mean</span>(muestra)</span>
<span id="cb219-6"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb219-6" aria-hidden="true" tabindex="-1"></a>media     <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, nsim)</span>
<span id="cb219-7"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb219-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nsim){</span>
<span id="cb219-8"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb219-8" aria-hidden="true" tabindex="-1"></a>  remuestreo <span class="ot">&lt;-</span> <span class="fu">sample</span>(muestra, n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb219-9"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb219-9" aria-hidden="true" tabindex="-1"></a>  media[i]   <span class="ot">&lt;-</span> <span class="fu">mean</span>(remuestreo)</span>
<span id="cb219-10"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb219-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb219-11"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb219-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-12"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb219-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Cálculo de cotas</span></span>
<span id="cb219-13"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb219-13" aria-hidden="true" tabindex="-1"></a>lado.sup <span class="ot">&lt;-</span> <span class="fu">quantile</span>(media <span class="sc">-</span> media.completa, alpha.val<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb219-14"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb219-14" aria-hidden="true" tabindex="-1"></a>lado.inf <span class="ot">&lt;-</span> <span class="fu">quantile</span>(media <span class="sc">-</span> media.completa, <span class="dv">1</span> <span class="sc">-</span> alpha.val<span class="sc">/</span><span class="dv">2</span>) </span>
<span id="cb219-15"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb219-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-16"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb219-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;El intervalo es [&quot;</span>, media.completa <span class="sc">-</span> lado.inf, </span>
<span id="cb219-17"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb219-17" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;,&quot;</span>, media.completa <span class="sc">-</span> lado.sup,<span class="st">&quot;]&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;El intervalo es [-0.05,0.4]&quot;</code></pre>
<p>El algoritmo es como sigue:
1. Obtén una muestra aleatoria simple con reemplazo <span class="math inline">\(X_1^B, X_2^B, \dots, X_n^B \sim \hat{F}\)</span> y calcula <span class="math inline">\(t(X_1^B, X_2^B, \dots, X_n^B)\)</span>
2. Repite <span class="math inline">\(n\)</span> veces (este <span class="math inline">\(n\)</span> se decide de recalculando la <span class="math inline">\(n\)</span> como si viniera de una muestra para tener la precisión deseada) o bien por convergencia.
3. Calcula los cuantiles simulados correspondientes <span class="math inline">\(\delta_1 = (t_B - t)_{\alpha/2}\)</span> y <span class="math inline">\(\delta_2 = (t_B - t)_{1 - \alpha/2}\)</span>
4. El intervalo es <span class="math inline">\(t - \delta_1\)</span> y <span class="math inline">\(t - \delta_2\)</span></p>
<blockquote>
<p><strong>Nota</strong> Boostrap no es perfecto para todo. Por ejemplo si se tiene una muestra de variables aleatorias <span class="math inline">\(X_i \sim \text{Unif}(0,1)\)</span> y se busca <span class="math inline">\(t_n = \min \{ X_i \}\)</span> bajo Bootstrap se puede demostrar que
<span class="math display">\[
n t_n \to \text{Exponencial}(1)
\]</span>
lo cual no corresponde al valor verdadero</p>
</blockquote>
</div>
<div id="boostrap-de-una-muestra" class="section level3" number="6.4.2">
<h3><span class="header-section-number">6.4.2</span> Boostrap de una muestra</h3>
<p>En el caso de una muestra aleatoria simple ponderada con estratos excluyentes <span class="math inline">\(S_1, S_2, \dots, S_{H}\)</span> de tamaños <span class="math inline">\(N_1, N_2, \dots, N_H\)</span> para cada estrato <span class="math inline">\(S_h\)</span> seleccionamos una muestra bootstrap a partir de lo cual podemos calcular una función de distribución empírica para cada estrato <span class="math inline">\(\hat{F}_h\)</span> y repetir el algoritmo (para cada estrato):</p>
<ol style="list-style-type: decimal">
<li>Crea una subpoblación <span class="math inline">\(U^f_h\)</span> fija de tamaño <span class="math inline">\(k = \Big\lfloor \frac{N_h}{n_h} \Big\rfloor\)</span> repitiendo la original <span class="math inline">\(k\)</span> veces.</li>
<li>Obtén <span class="math inline">\(U^c_h\)</span> una muestra aleatoria de <span class="math inline">\(S_h\)</span> de tamaño <span class="math inline">\(N - nk\)</span>. Crea la pseudo población bootstrap como <span class="math inline">\(U^{boot}_h = U^c_h \cup U^f_h\)</span>.</li>
<li>Obtén una muestra de <span class="math inline">\(U^{boot}_h\)</span> de tamaño <span class="math inline">\(n_h\)</span> y recalcula el parámetro de interés <span class="math inline">\(t_B = t(F_h^{boot})\)</span>.</li>
<li>Repite <span class="math inline">\(m\)</span> veces (este <span class="math inline">\(m\)</span> se decide de recalculando la <span class="math inline">\(n\)</span> como si viniera de una muestra para tener la precisión deseada) o bien por convergencia.</li>
<li>Calcula los cuantiles simulados correspondientes <span class="math inline">\(\delta_1 = (t_B - t)_{\alpha/2}\)</span> y <span class="math inline">\(\delta_2 = (t_B - t)_{1 - \alpha/2}\)</span></li>
<li>El intervalo es <span class="math inline">\(t - \delta_1\)</span> y <span class="math inline">\(t - \delta_2\)</span></li>
</ol>
<p>El método anterior es el desarrollado por <a href="http://www.jstor.org/stable/2290991?origin=JSTOR-pdf">Booth, Butler y Hall</a>; sin embargo no es el único que existe. Para poblaciones finitas te sugiero checar el compendio de <a href="https://projecteuclid.org/euclid.ssu">Mashreghi, Haziza y Léger</a> donde vienen varios métodos.</p>
</div>
<div id="ejemplo-4" class="section level3" number="6.4.3">
<h3><span class="header-section-number">6.4.3</span> Ejemplo</h3>
<p>Calcular la mediana de la siguiente población:</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb221-1" aria-hidden="true" tabindex="-1"></a>pop.total <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">100</span>), <span class="fu">rexp</span>(<span class="dv">100</span>), <span class="fu">rpois</span>(<span class="dv">100</span>, <span class="dv">2</span>))</span>
<span id="cb221-2"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb221-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">length</span>(pop.total)</span>
<span id="cb221-3"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb221-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-4"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb221-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Verdadera mediana</span></span>
<span id="cb221-5"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb221-5" aria-hidden="true" tabindex="-1"></a>mediana.real <span class="ot">&lt;-</span> <span class="fu">median</span>(pop.total)</span>
<span id="cb221-6"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb221-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-7"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb221-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Obtenemos muestra de tamaño n = 25 por ejemplo</span></span>
<span id="cb221-8"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb221-8" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb221-9"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb221-9" aria-hidden="true" tabindex="-1"></a>muestra          <span class="ot">&lt;-</span> <span class="fu">sample</span>(pop.total, <span class="dv">25</span>)</span>
<span id="cb221-10"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb221-10" aria-hidden="true" tabindex="-1"></a>mediana.muestral <span class="ot">&lt;-</span> <span class="fu">median</span>(muestra)</span>
<span id="cb221-11"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb221-11" aria-hidden="true" tabindex="-1"></a>mediana          <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, nsim)</span>
<span id="cb221-12"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb221-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-13"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb221-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;El valor real es &quot;</span>, mediana.real))</span></code></pre></div>
<pre><code>## [1] &quot;El valor real es 0.629704617234562&quot;</code></pre>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Tamaño de bootstrap</span></span>
<span id="cb223-2"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb223-2" aria-hidden="true" tabindex="-1"></a>k.val <span class="ot">&lt;-</span> <span class="fu">floor</span>(N<span class="sc">/</span>n)</span>
<span id="cb223-3"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb223-3" aria-hidden="true" tabindex="-1"></a>Uf    <span class="ot">&lt;-</span> <span class="fu">rep</span>(muestra, k.val)</span>
<span id="cb223-4"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb223-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-5"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb223-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-6"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb223-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nsim){</span>
<span id="cb223-7"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb223-7" aria-hidden="true" tabindex="-1"></a>  Uc         <span class="ot">&lt;-</span> <span class="fu">sample</span>(muestra, N <span class="sc">-</span> n<span class="sc">*</span>k.val, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb223-8"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb223-8" aria-hidden="true" tabindex="-1"></a>  Uboot      <span class="ot">&lt;-</span> <span class="fu">c</span>(Uf, Uc)</span>
<span id="cb223-9"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb223-9" aria-hidden="true" tabindex="-1"></a>  remuestreo <span class="ot">&lt;-</span> <span class="fu">sample</span>(Uboot, n, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb223-10"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb223-10" aria-hidden="true" tabindex="-1"></a>  mediana[i] <span class="ot">&lt;-</span> <span class="fu">median</span>(remuestreo)</span>
<span id="cb223-11"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb223-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb223-12"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb223-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-13"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb223-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Cálculo de cotas</span></span>
<span id="cb223-14"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb223-14" aria-hidden="true" tabindex="-1"></a>lado.sup <span class="ot">&lt;-</span> <span class="fu">quantile</span>(mediana <span class="sc">-</span> mediana.muestral, alpha.val<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb223-15"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb223-15" aria-hidden="true" tabindex="-1"></a>lado.inf <span class="ot">&lt;-</span> <span class="fu">quantile</span>(mediana <span class="sc">-</span> mediana.muestral, <span class="dv">1</span> <span class="sc">-</span> alpha.val<span class="sc">/</span><span class="dv">2</span>) </span>
<span id="cb223-16"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb223-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-17"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb223-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;El intervalo es [&quot;</span>, mediana.muestral <span class="sc">-</span> lado.inf, </span>
<span id="cb223-18"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb223-18" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;,&quot;</span>, mediana.muestral <span class="sc">-</span> lado.sup,<span class="st">&quot;]&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;El intervalo es [-0.12970966652169,0.838248776470654]&quot;</code></pre>
</div>
<div id="ejercicio-10" class="section level3" number="6.4.4">
<h3><span class="header-section-number">6.4.4</span> Ejercicio</h3>
<p>De una población de árboles se midieron las alturas según distintos tipos de semilla. Esta información está contenida en <code>R</code> en una base de datos precargada:</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Loblolly)</span>
<span id="cb225-2"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb225-2" aria-hidden="true" tabindex="-1"></a>arboles <span class="ot">&lt;-</span> Loblolly</span></code></pre></div>
<ol style="list-style-type: decimal">
<li><p>Suponiendo que para la semilla <span class="math inline">\(305\)</span> se realizó muestreo aleatorio simple sin reemplazo de un total <span class="math inline">\(N = 100\)</span> árboles, estima la mediana de altura y los cuantiles <span class="math inline">\(0.25\)</span> y <span class="math inline">\(0.75\)</span> de la misma junto con sus intervalos de confianza mediante <em>bootstrap</em>.</p></li>
<li><p>Suponiendo que para la semilla <span class="math inline">\(307\)</span> se realizó muestreo aleatorio simple sin reemplazo de un total <span class="math inline">\(N = 300\)</span> árboles, estima la media y varianza de altura junto con sus intervalos de confianza mediante <em>bootstrap</em>.</p></li>
<li><p>Estima para <strong>todos los árboles</strong> (es decir no sólo para los estratos sino para la población completa) la altura promedio, la altura mediana, los cuantiles <span class="math inline">\(0.25\)</span> y <span class="math inline">\(0.75\)</span> de altura así como la curtosis y la asimetría de la misma junto con sus intervalos de confianza mediante <em>bootstrap</em> suponiendo las <span class="math inline">\(N_h\)</span> son:</p></li>
</ol>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Semilla
</th>
<th style="text-align:right;">
Nh
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
301
</td>
<td style="text-align:right;">
960
</td>
</tr>
<tr>
<td style="text-align:left;">
303
</td>
<td style="text-align:right;">
1008
</td>
</tr>
<tr>
<td style="text-align:left;">
305
</td>
<td style="text-align:right;">
968
</td>
</tr>
<tr>
<td style="text-align:left;">
307
</td>
<td style="text-align:right;">
1029
</td>
</tr>
<tr>
<td style="text-align:left;">
309
</td>
<td style="text-align:right;">
995
</td>
</tr>
<tr>
<td style="text-align:left;">
311
</td>
<td style="text-align:right;">
994
</td>
</tr>
<tr>
<td style="text-align:left;">
315
</td>
<td style="text-align:right;">
1025
</td>
</tr>
<tr>
<td style="text-align:left;">
319
</td>
<td style="text-align:right;">
979
</td>
</tr>
<tr>
<td style="text-align:left;">
321
</td>
<td style="text-align:right;">
1008
</td>
</tr>
<tr>
<td style="text-align:left;">
323
</td>
<td style="text-align:right;">
1046
</td>
</tr>
<tr>
<td style="text-align:left;">
325
</td>
<td style="text-align:right;">
1064
</td>
</tr>
<tr>
<td style="text-align:left;">
327
</td>
<td style="text-align:right;">
1012
</td>
</tr>
<tr>
<td style="text-align:left;">
329
</td>
<td style="text-align:right;">
996
</td>
</tr>
<tr>
<td style="text-align:left;">
331
</td>
<td style="text-align:right;">
1015
</td>
</tr>
</tbody>
</table>
<ol start="4" style="list-style-type: decimal">
<li>Considera una población de tamaño <span class="math inline">\(N = 1000\)</span> y una muestra aleatoria sin reemplazo de la misma de tamaño <span class="math inline">\(n = 71\)</span> dada por:</li>
</ol>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">64</span>)</span>
<span id="cb226-2"><a href="intervalos-de-confianza-mediante-bootstrap.html#cb226-2" aria-hidden="true" tabindex="-1"></a>muestra <span class="ot">&lt;-</span> <span class="fu">rlnorm</span>(<span class="dv">71</span>)</span></code></pre></div>
<p>grafica la función de distribución empírica (asociada a la muestra) y grafica intervalos de confianza para la misma en el intervalo <span class="math inline">\([0.1, 0.9]\)</span>.</p>
<blockquote>
<p><strong>Tip</strong> Genera intervalos de confianza mediante boostrap asociados a <span class="math inline">\(\hat{F}(0.1)\)</span>, <span class="math inline">\(\hat{F}(0.2)\)</span>, <span class="math inline">\(\hat{F}(0.3)\)</span>, <span class="math inline">\(\hat{F}(0.4)\)</span>, <span class="math inline">\(\hat{F}(0.5)\)</span>, <span class="math inline">\(\hat{F}(0.6)\)</span>, <span class="math inline">\(\hat{F}(0.7)\)</span>, <span class="math inline">\(\hat{F}(0.8)\)</span>, y <span class="math inline">\(\hat{F}(0.9)\)</span></p>
</blockquote>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="muestreo-aleatorio-estratificado.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="muestreo-aleatorio-multietápico.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": true,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": true,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/RodrigoZepeda/LibroEstadistica/edit/master/04-intervalos_de_confianza.Rmd",
"text": "Colaborar"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed",
"download": ["pdf", "epub"],
"search": true,
"fontsettings": {
"theme": ["night", "white", "sepia"],
"family": "sans",
"size": [2, 4]
}
},
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
